(function(a,c){typeof exports=="object"&&typeof module!="undefined"?c(exports,require("graphql")):typeof define=="function"&&define.amd?define(["exports","graphql"],c):(a=typeof globalThis!="undefined"?globalThis:a||self,c(a["@nhost/graphql-js"]={},a.graphql))})(this,function(a,c){"use strict";function g(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function b(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function s(){if(this instanceof s){var r=[null];r.push.apply(r,arguments);var l=Function.bind.apply(t,r);return new l}return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var r=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return e[s]}})}),n}function v(e,t){return t=t||{},new Promise(function(n,s){var r=new XMLHttpRequest,l=[],p=[],i={},d=function(){return{ok:(r.status/100|0)==2,statusText:r.statusText,status:r.status,url:r.responseURL,text:function(){return Promise.resolve(r.responseText)},json:function(){return Promise.resolve(r.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([r.response]))},clone:d,headers:{keys:function(){return l},entries:function(){return p},get:function(u){return i[u.toLowerCase()]},has:function(u){return u.toLowerCase()in i}}}};for(var h in r.open(t.method||"get",e,!0),r.onload=function(){r.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(u,o,f){l.push(o=o.toLowerCase()),p.push([o,f]),i[o]=i[o]?i[o]+","+f:f}),n(d())},r.onerror=s,r.withCredentials=t.credentials=="include",t.headers)r.setRequestHeader(h,t.headers[h]);r.send(t.body||null)})}const m=b(Object.freeze(Object.defineProperty({__proto__:null,default:v},Symbol.toStringTag,{value:"Module"})));var T=self.fetch||(self.fetch=m.default||m);const _=g(T);function q(e,t,n){return e.document?e:{document:e,variables:t,config:n}}function y(e){var s;let t;const n=e.definitions.filter(r=>r.kind==="OperationDefinition");return n.length===1&&(t=(s=n[0].name)==null?void 0:s.value),t}function w(e){if(typeof e=="string"){let n;try{const s=c.parse(e);n=y(s)}catch{}return{query:e,operationName:n}}const t=y(e);return{query:c.print(e),operationName:t}}class j{constructor(t){const{url:n,adminSecret:s}=t;this._url=n,this.accessToken=null,this.adminSecret=s}async request(t,...n){const[s,r]=n,l=q(t,s,r),{headers:p,...i}=r||{},{query:d,operationName:h}=w(l.document);try{const u=await _(this.httpUrl,{method:"POST",body:JSON.stringify({operationName:h,query:d,variables:s}),headers:{"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...p},...i});if(!u.ok)return{data:null,error:{error:u.statusText,message:u.statusText,status:u.status}};const{data:o,errors:f}=await u.json();return f?{data:null,error:f}:typeof o!="object"||Array.isArray(o)||o===null?{data:null,error:{error:"invalid-response",message:"incorrect response data from GraphQL server",status:0}}:{data:o,error:null}}catch(u){const o=u;return{data:null,error:{message:o.message,status:o.name==="AbortError"?0:500,error:o.name==="AbortError"?"abort-error":"unknown"}}}}get httpUrl(){return this._url}get wsUrl(){return this._url.replace(/^(http)(s?):\/\//,"ws$2://")}get url(){return this._url}getUrl(){return this._url}setAccessToken(t){if(!t){this.accessToken=null;return}this.accessToken=t}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}a.NhostGraphqlClient=j,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=graphql-js.umd.js.map
