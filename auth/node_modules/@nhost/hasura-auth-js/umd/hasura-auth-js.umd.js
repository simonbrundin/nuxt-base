(function(E,ie){typeof exports=="object"&&typeof module!="undefined"?ie(exports):typeof define=="function"&&define.amd?define(["exports"],ie):(E=typeof globalThis!="undefined"?globalThis:E||self,ie(E["@nhost/hasura-auth-js"]={}))})(this,function(E){"use strict";const ie="nhostRefreshToken",ke="nhostRefreshTokenId",pe="nhostRefreshTokenExpiresAt";class xe extends Error{constructor(e){super(e.message),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),e instanceof Error?(this.name=e.name,this.error={error:e.name,status:1,message:e.message}):(this.name=e.error,this.error=e)}}const ae={status:10,error:"invalid-email",message:"Email is incorrectly formatted"},Ft={status:10,error:"invalid-mfa-type",message:"MFA type is invalid"},Bt={status:10,error:"invalid-mfa-code",message:"MFA code is invalid"},Be={status:10,error:"invalid-password",message:"Password is incorrectly formatted"},ft={status:10,error:"invalid-phone-number",message:"Phone number is incorrectly formatted"},Gt={status:10,error:"invalid-mfa-ticket",message:"MFA ticket is invalid"},Ht={status:10,error:"no-mfa-ticket",message:"No MFA ticket has been provided"},$t={status:10,error:"no-refresh-token",message:"No refresh token has been provided"},qt={status:20,error:"refresher-already-running",message:"The token refresher is already running. You must wait until is has finished before submitting a new token."},te={status:20,error:"already-signed-in",message:"User is already signed in"},Wt={status:20,error:"unauthenticated-user",message:"User is not authenticated"},Jr={status:20,error:"user-not-anonymous",message:"User is not anonymous"},Yt={status:20,error:"unverified-user",message:"Email needs verification"},zt={status:10,error:"invalid-refresh-token",message:"Invalid or expired refresh token"},Xt={status:1,error:"invalid-sign-in-method",message:"Invalid sign-in method"};function ht(t){this.message=t}ht.prototype=new Error,ht.prototype.name="InvalidCharacterError";var Qt=typeof window!="undefined"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new ht("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,i=0,s=0,o="";n=e.charAt(s++);~n&&(r=i%4?64*r+n:n,i++%4)?o+=String.fromCharCode(255&r>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o};function Zr(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(r){return decodeURIComponent(Qt(r).replace(/(.)/g,function(n,i){var s=i.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}(e)}catch{return Qt(e)}}function Ge(t){this.message=t}function en(t,e){if(typeof t!="string")throw new Ge("Invalid token specified");var r=(e=e||{}).header===!0?0:1;try{return JSON.parse(Zr(t.split(".")[r]))}catch(n){throw new Ge("Invalid token specified: "+n.message)}}Ge.prototype=new Error,Ge.prototype.name="InvalidTokenError";/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var g=function(){return g=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},g.apply(this,arguments)};function dt(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function I(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function k(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function V(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var L;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(L||(L={}));var le;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(le||(le={}));var pt=L.Start,vt=L.Stop,me=L.Raise,ge=L.Send,Jt=L.Cancel,tn=L.NullEvent,yt=L.Assign;L.After,L.DoneState;var Zt=L.Log,rn=L.Init,mt=L.Invoke;L.ErrorExecution;var er=L.ErrorPlatform,nn=L.ErrorCustom,tr=L.Update,sn=L.Choose,on=L.Pure,rr=".",nr={},gt="xstate.guard",an="",H=process.env.NODE_ENV==="production",He;function Et(t,e,r){r===void 0&&(r=rr);var n=Ne(t,r),i=Ne(e,r);return D(i)?D(n)?i===n:!1:D(n)?n in i:Object.keys(n).every(function(s){return s in i?Et(n[s],i[s]):!1})}function ir(t){try{return D(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function wt(t,e){try{return Ee(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function cn(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function Ne(t,e){if(cn(t))return t.value;if(Ee(t))return $e(t);if(typeof t!="string")return t;var r=wt(t,e);return $e(r)}function $e(t){if(t.length===1)return t[0];for(var e={},r=e,n=0;n<t.length-1;n++)n===t.length-2?r[t[n]]=t[n+1]:(r[t[n]]={},r=r[t[n]]);return e}function Pe(t,e){for(var r={},n=Object.keys(t),i=0;i<n.length;i++){var s=n[i];r[s]=e(t[s],s,t,i)}return r}function sr(t,e,r){var n,i,s={};try{for(var o=I(Object.keys(t)),u=o.next();!u.done;u=o.next()){var c=u.value,h=t[c];r(h)&&(s[c]=e(h,c,t))}}catch(a){n={error:a}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}var un=function(t){return function(e){var r,n,i=e;try{for(var s=I(t),o=s.next();!o.done;o=s.next()){var u=o.value;i=i[u]}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}};function ln(t,e){return function(r){var n,i,s=r;try{for(var o=I(t),u=o.next();!u.done;u=o.next()){var c=u.value;s=s[e][c]}}catch(h){n={error:h}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}}function qe(t){if(!t)return[[]];if(D(t))return[[t]];var e=G(Object.keys(t).map(function(r){var n=t[r];return typeof n!="string"&&(!n||!Object.keys(n).length)?[[r]]:qe(t[r]).map(function(i){return[r].concat(i)})}));return e}function G(t){var e;return(e=[]).concat.apply(e,V([],k(t),!1))}function or(t){return Ee(t)?t:[t]}function re(t){return t===void 0?[]:or(t)}function We(t,e,r){var n,i;if(j(t))return t(e,r.data);var s={};try{for(var o=I(Object.keys(t)),u=o.next();!u.done;u=o.next()){var c=u.value,h=t[c];j(h)?s[c]=h(e,r.data):s[c]=h}}catch(a){n={error:a}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}function fn(t){return/^(done|error)\./.test(t)}function ar(t){return!!(t instanceof Promise||t!==null&&(j(t)||typeof t=="object")&&j(t.then))}function hn(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function dn(t,e){var r,n,i=k([[],[]],2),s=i[0],o=i[1];try{for(var u=I(t),c=u.next();!c.done;c=u.next()){var h=c.value;e(h)?s.push(h):o.push(h)}}catch(a){r={error:a}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return[s,o]}function cr(t,e){return Pe(t.states,function(r,n){if(r){var i=(D(e)?void 0:e[n])||(r?r.current:void 0);if(i)return{current:i,states:cr(r,i)}}})}function pn(t,e){return{current:e,states:cr(t,e)}}function ur(t,e,r,n){H||Y(!!t,"Attempting to update undefined context");var i=t&&r.reduce(function(s,o){var u,c,h=o.assignment,a={state:n,action:o,_event:e},f={};if(j(h))f=h(s,e.data,a);else try{for(var l=I(Object.keys(h)),p=l.next();!p.done;p=l.next()){var v=p.value,m=h[v];f[v]=j(m)?m(s,e.data,a):m}}catch(S){u={error:S}}finally{try{p&&!p.done&&(c=l.return)&&c.call(l)}finally{if(u)throw u.error}}return Object.assign({},s,f)},t);return i}var Y=function(){};H||(Y=function(t,e){var r=t instanceof Error?t:void 0;if(!(!r&&t)&&console!==void 0){var n=["Warning: ".concat(e)];r&&n.push(r),console.warn.apply(console,n)}});function Ee(t){return Array.isArray(t)}function j(t){return typeof t=="function"}function D(t){return typeof t=="string"}function lr(t,e){if(t)return D(t)?{type:gt,name:t,predicate:e?e[t]:void 0}:j(t)?{type:gt,name:t.name,predicate:t}:t}function vn(t){try{return"subscribe"in t&&j(t.subscribe)}catch{return!1}}var fe=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();He={},He[fe]=function(){return this},He[Symbol.observable]=function(){return this};function ve(t){return!!t&&"__xstatenode"in t}function yn(t){return!!t&&typeof t.send=="function"}function Tt(t,e){return D(t)||typeof t=="number"?g({type:t},e):t}function z(t,e){if(!D(t)&&"$$type"in t&&t.$$type==="scxml")return t;var r=Tt(t);return g({name:r.type,data:r,$$type:"scxml",type:"external"},e)}function we(t,e){var r=or(e).map(function(n){return typeof n=="undefined"||typeof n=="string"||ve(n)?{target:n,event:t}:g(g({},n),{event:t})});return r}function mn(t){if(!(t===void 0||t===an))return re(t)}function gn(t,e,r){if(!H){var n=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";if(t===e)console.error("Missing onError handler for invocation '".concat(r,"', error was '").concat(t,"'.").concat(n));else{var i=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(r,"'. ")+"Original error: '".concat(t,"'. ").concat(n," Current error is '").concat(e,"'.").concat(i))}}}function fr(t,e,r,n,i){var s=t.options.guards,o={state:i,cond:e,_event:n};if(e.type===gt)return((s==null?void 0:s[e.name])||e.predicate)(r,n.data,o);var u=s==null?void 0:s[e.type];if(!u)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return u(r,n.data,o)}function hr(t){return typeof t=="string"?{type:t}:t}function Ye(t,e,r){var n=function(){},i=typeof t=="object",s=i?t:null;return{next:((i?t.next:t)||n).bind(s),error:((i?t.error:e)||n).bind(s),complete:((i?t.complete:r)||n).bind(s)}}function ze(t,e){return"".concat(t,":invocation[").concat(e,"]")}var Te=z({type:rn});function St(t,e){return e&&e[t]||void 0}function De(t,e){var r;if(D(t)||typeof t=="number"){var n=St(t,e);j(n)?r={type:t,exec:n}:n?r=n:r={type:t,exec:void 0}}else if(j(t))r={type:t.name||t.toString(),exec:t};else{var n=St(t.type,e);if(j(n))r=g(g({},t),{exec:n});else if(n){var i=n.type||t.type;r=g(g(g({},n),t),{type:i})}else r=t}return r}var he=function(t,e){if(!t)return[];var r=Ee(t)?t:[t];return r.map(function(n){return De(n,e)})};function At(t){var e=De(t);return g(g({id:D(t)?t:e.id},e),{type:e.type})}function En(t){return D(t)?{type:me,event:t}:bt(t,{to:le.Internal})}function wn(t){return{type:me,_event:z(t.event)}}function bt(t,e){return{to:e?e.to:void 0,type:ge,event:j(t)?t:Tt(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:j(t)?t.name:ir(t)}}function Tn(t,e,r,n){var i={_event:r},s=z(j(t.event)?t.event(e,r.data,i):t.event),o;if(D(t.delay)){var u=n&&n[t.delay];o=j(u)?u(e,r.data,i):u}else o=j(t.delay)?t.delay(e,r.data,i):t.delay;var c=j(t.to)?t.to(e,r.data,i):t.to;return g(g({},t),{to:c,_event:s,event:s.data,delay:o})}var Sn=function(t,e,r){return g(g({},t),{value:D(t.expr)?t.expr:t.expr(e,r.data,{_event:r})})},An=function(t){return{type:Jt,sendId:t}};function bn(t){var e=At(t);return{type:L.Start,activity:e,exec:void 0}}function Rn(t){var e=j(t)?t:At(t);return{type:L.Stop,activity:e,exec:void 0}}function On(t,e,r){var n=j(t.activity)?t.activity(e,r.data):t.activity,i=typeof n=="string"?{id:n}:n,s={type:L.Stop,activity:i};return s}var _n=function(t){return{type:yt,assignment:t}};function In(t,e){var r=e?"#".concat(e):"";return"".concat(L.After,"(").concat(t,")").concat(r)}function Xe(t,e){var r="".concat(L.DoneState,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function Qe(t,e){var r="".concat(L.DoneInvoke,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function Ce(t,e){var r="".concat(L.ErrorPlatform,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}var kn=function(t){var e,r,n=[];try{for(var i=I(t),s=i.next();!s.done;s=i.next())for(var o=s.value,u=0;u<o.length;){if(o[u].type===yt){n.push(o[u]),o.splice(u,1);continue}u++}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n};function Je(t,e,r,n,i,s,o){o===void 0&&(o=!1);var u=o?[]:kn(i),c=u.length?ur(r,n,u,e):r,h=o?[r]:void 0,a=[];function f(v){var m;switch(v.type){case me:return wn(v);case ge:var S=Tn(v,c,n,t.options.delays);return H||Y(!D(v.delay)||typeof S.delay=="number","No delay reference for delay expression '".concat(v.delay,"' was found on machine '").concat(t.id,"'")),s&&S.to!==le.Internal&&a.push(S),S;case Zt:{var w=Sn(v,c,n);return s==null||s(w,c,n),w}case sn:{var T=v,A=(m=T.conds.find(function(ee){var $=lr(ee.cond,t.options.guards);return!$||fr(t,$,c,n,s?void 0:e)}))===null||m===void 0?void 0:m.actions;if(!A)return[];var C=k(Je(t,e,c,n,[he(re(A),t.options.actions)],s,o),2),O=C[0],F=C[1];return c=F,h==null||h.push(c),O}case on:{var A=v.get(c,n.data);if(!A)return[];var _=k(Je(t,e,c,n,[he(re(A),t.options.actions)],s,o),2),N=_[0],M=_[1];return c=M,h==null||h.push(c),N}case vt:{var w=On(v,c,n);return s==null||s(w,r,n),w}case yt:{c=ur(c,n,[v],s?void 0:e),h==null||h.push(c);break}default:var b=De(v,t.options.actions),x=b.exec;if(s)s(b,c,n);else if(x&&h){var J=h.length-1;b=g(g({},b),{exec:function(ee){for(var $=[],de=1;de<arguments.length;de++)$[de-1]=arguments[de];x.apply(void 0,V([h[J]],k($),!1))}})}return b}}function l(v){var m,S,w=[];try{for(var T=I(v),A=T.next();!A.done;A=T.next()){var C=A.value,O=f(C);O&&(w=w.concat(O))}}catch(F){m={error:F}}finally{try{A&&!A.done&&(S=T.return)&&S.call(T)}finally{if(m)throw m.error}}return a.forEach(function(F){s(F,c,n)}),a.length=0,w}var p=G(i.map(l));return[p,c]}var dr=[],Se=function(t,e){dr.push(t);var r=e(t);return dr.pop(),r};function pr(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[fe]=function(){return this},e}function xn(t,e,r,n){var i,s=hr(t.src),o=(i=e==null?void 0:e.options.services)===null||i===void 0?void 0:i[s.type],u=t.data?We(t.data,r,n):void 0,c=o?vr(o,t.id,u):pr(t.id);return c.meta=t,c}function vr(t,e,r){var n=pr(e);if(n.deferred=!0,ve(t)){var i=n.state=Se(void 0,function(){return(r?t.withContext(r):t).initialState});n.getSnapshot=function(){return i}}return n}function Nn(t){try{return typeof t.send=="function"}catch{return!1}}function Pn(t){return Nn(t)&&"id"in t}function Dn(t){var e;return g((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[fe]=function(){return this},e),t)}var Ze=function(t){return t.type==="atomic"||t.type==="final"};function yr(t){return Object.keys(t.states).map(function(e){return t.states[e]})}function Me(t){return yr(t).filter(function(e){return e.type!=="history"})}function mr(t){var e=[t];return Ze(t)?e:e.concat(G(Me(t).map(mr)))}function Ue(t,e){var r,n,i,s,o,u,c,h,a=new Set(t),f=Rt(a),l=new Set(e);try{for(var p=I(l),v=p.next();!v.done;v=p.next())for(var m=v.value,S=m.parent;S&&!l.has(S);)l.add(S),S=S.parent}catch(M){r={error:M}}finally{try{v&&!v.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}var w=Rt(l);try{for(var T=I(l),A=T.next();!A.done;A=T.next()){var m=A.value;if(m.type==="compound"&&(!w.get(m)||!w.get(m).length))f.get(m)?f.get(m).forEach(function(b){return l.add(b)}):m.initialStateNodes.forEach(function(b){return l.add(b)});else if(m.type==="parallel")try{for(var C=(o=void 0,I(Me(m))),O=C.next();!O.done;O=C.next()){var F=O.value;l.has(F)||(l.add(F),f.get(F)?f.get(F).forEach(function(b){return l.add(b)}):F.initialStateNodes.forEach(function(b){return l.add(b)}))}}catch(b){o={error:b}}finally{try{O&&!O.done&&(u=C.return)&&u.call(C)}finally{if(o)throw o.error}}}}catch(M){i={error:M}}finally{try{A&&!A.done&&(s=T.return)&&s.call(T)}finally{if(i)throw i.error}}try{for(var _=I(l),N=_.next();!N.done;N=_.next())for(var m=N.value,S=m.parent;S&&!l.has(S);)l.add(S),S=S.parent}catch(M){c={error:M}}finally{try{N&&!N.done&&(h=_.return)&&h.call(_)}finally{if(c)throw c.error}}return l}function gr(t,e){var r=e.get(t);if(!r)return{};if(t.type==="compound"){var n=r[0];if(n){if(Ze(n))return n.key}else return{}}var i={};return r.forEach(function(s){i[s.key]=gr(s,e)}),i}function Rt(t){var e,r,n=new Map;try{for(var i=I(t),s=i.next();!s.done;s=i.next()){var o=s.value;n.has(o)||n.set(o,[]),o.parent&&(n.has(o.parent)||n.set(o.parent,[]),n.get(o.parent).push(o))}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function Cn(t,e){var r=Ue([t],e);return gr(t,Rt(r))}function Le(t,e){return Array.isArray(t)?t.some(function(r){return r===e}):t instanceof Set?t.has(e):!1}function Mn(t){return V([],k(new Set(G(V([],k(t.map(function(e){return e.ownEvents})),!1)))),!1)}function et(t,e){return e.type==="compound"?Me(e).some(function(r){return r.type==="final"&&Le(t,r)}):e.type==="parallel"?Me(e).every(function(r){return et(t,r)}):!1}function Un(t){return t===void 0&&(t=[]),t.reduce(function(e,r){return r.meta!==void 0&&(e[r.id]=r.meta),e},{})}function Er(t){return new Set(G(t.map(function(e){return e.tags})))}function wr(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(D(t)||D(e))return t===e;var r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every(function(i){return wr(t[i],e[i])})}function Ln(t){return typeof t!="object"||t===null?!1:"value"in t&&"_event"in t}function jn(t,e){var r=t.exec,n=g(g({},t),{exec:r!==void 0?function(){return r(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return n}var se=function(){function t(e){var r=this,n;this.actions=[],this.activities=nr,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||nr,this.meta=Un(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(n=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&n!==void 0?n:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return Mn(r.configuration)}})}return t.from=function(e,r){if(e instanceof t)return e.context!==r?new t({value:e.value,context:r,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var n=Te;return new t({value:e,context:r,_event:n,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,r){if(e instanceof t){if(!e.actions.length)return e;var n=Te;return new t({value:e.value,context:r,_event:n,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,r)},t.prototype.toStrings=function(e,r){var n=this;if(e===void 0&&(e=this.value),r===void 0&&(r="."),D(e))return[e];var i=Object.keys(e);return i.concat.apply(i,V([],k(i.map(function(s){return n.toStrings(e[s],r).map(function(o){return s+r+o})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var r=e.tags;e.machine;var n=dt(e,["configuration","transitions","tags","machine"]);return g(g({},n),{tags:Array.from(r)})},t.prototype.matches=function(e){return Et(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var r;H&&Y(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=(r=this.machine)===null||r===void 0?void 0:r.getTransitionData(this,e);return!!(n!=null&&n.transitions.length)&&n.transitions.some(function(i){return i.target!==void 0||i.actions.length})},t}(),Vn={deferEvents:!1},Tr=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=g(g({},Vn),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(r){throw this.clear(),r}finally{this.processingEvent=!1}},t}(),Ot=new Map,Kn=0,tt={bookId:function(){return"x:".concat(Kn++)},register:function(t,e){return Ot.set(t,e),t},get:function(t){return Ot.get(t)},free:function(t){Ot.delete(t)}};function _t(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;H||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues")}function Fn(){var t=_t();if(t&&"__xstate__"in t)return t.__xstate__}function Bn(t){if(_t()){var e=Fn();e&&e.register(t)}}function Gn(t,e){e===void 0&&(e={});var r=t.initialState,n=new Set,i=[],s=!1,o=function(){if(!s){for(s=!0;i.length>0;){var h=i.shift();r=t.transition(r,h,c),n.forEach(function(a){return a.next(r)})}s=!1}},u=Dn({id:e.id,send:function(h){i.push(h),o()},getSnapshot:function(){return r},subscribe:function(h,a,f){var l=Ye(h,a,f);return n.add(l),l.next(r),{unsubscribe:function(){n.delete(l)}}}}),c={parent:e.parent,self:u,id:e.id||"anonymous",observers:n};return r=t.start?t.start(c):r,u}var Hn={sync:!1,autoForward:!1},W;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(W||(W={}));var $n=function(){function t(e,r){r===void 0&&(r=t.defaultOptions);var n=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=W.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(a,f){if(Ee(a))return n.batch(a),n.state;var l=z(Tt(a,f));if(n.status===W.Stopped)return H||Y(!1,'Event "'.concat(l.name,'" was sent to stopped service "').concat(n.machine.id,`". This service has already reached its final state, and will not transition.
Event: `).concat(JSON.stringify(l.data))),n.state;if(n.status!==W.Running&&!n.options.deferEvents)throw new Error('Event "'.concat(l.name,'" was sent to uninitialized service "').concat(n.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(l.data)));return n.scheduler.schedule(function(){n.forward(l);var p=n._nextState(l);n.update(p,l)}),n._state},this.sendTo=function(a,f,l){var p=n.parent&&(f===le.Parent||n.parent.id===f),v=p?n.parent:D(f)?n.children.get(f)||tt.get(f):yn(f)?f:void 0;if(!v){if(!p)throw new Error("Unable to send event to child '".concat(f,"' from service '").concat(n.id,"'."));H||Y(!1,"Service '".concat(n.id,"' has no parent: unable to send event ").concat(a.type));return}if("machine"in v){if(n.status!==W.Stopped||n.parent!==v||n.state.done){var m=g(g({},a),{name:a.name===nn?"".concat(Ce(n.id)):a.name,origin:n.sessionId});!l&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([v,m]):v.send(m)}}else!l&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([v,a.data]):v.send(a.data)},this._exec=function(a,f,l,p){p===void 0&&(p=n.machine.options.actions);var v=a.exec||St(a.type,p),m=j(v)?v:v?v.exec:a.exec;if(m)try{return m(f,l.data,n.machine.config.predictableActionArguments?{action:a,_event:l}:{action:a,state:n.state,_event:l})}catch(J){throw n.parent&&n.parent.send({type:"xstate.error",data:J}),J}switch(a.type){case ge:var S=a;if(typeof S.delay=="number"){n.defer(S);return}else S.to?n.sendTo(S._event,S.to,l===Te):n.send(S._event);break;case Jt:n.cancel(a.sendId);break;case pt:{if(n.status!==W.Running)return;var w=a.activity;if(!n.machine.config.predictableActionArguments&&!n.state.activities[w.id||w.type])break;if(w.type===L.Invoke){var T=hr(w.src),A=n.machine.options.services?n.machine.options.services[T.type]:void 0,C=w.id,O=w.data;H||Y(!("forward"in w),"`forward` property is deprecated (found in invocation of '".concat(w.src,"' in in machine '").concat(n.machine.id,"'). ")+"Please use `autoForward` instead.");var F="autoForward"in w?w.autoForward:!!w.forward;if(!A){H||Y(!1,"No service found for invocation '".concat(w.src,"' in machine '").concat(n.machine.id,"'."));return}var _=O?We(O,f,l):void 0;if(typeof A=="string")return;var N=j(A)?A(f,l.data,{data:_,src:T,meta:w.meta}):A;if(!N)return;var M=void 0;ve(N)&&(N=_?N.withContext(_):N,M={autoForward:F}),n.spawn(N,C,M)}else n.spawnActivity(w);break}case vt:{n.stopChild(a.activity.id);break}case Zt:var b=a.label,x=a.value;b?n.logger(b,x):n.logger(x);break;default:H||Y(!1,"No implementation found for action type '".concat(a.type,"'"));break}};var i=g(g({},t.defaultOptions),r),s=i.clock,o=i.logger,u=i.parent,c=i.id,h=c!==void 0?c:e.id;this.id=h,this.logger=o,this.clock=s,this.parent=u,this.options=i,this.scheduler=new Tr({deferEvents:this.options.deferEvents}),this.sessionId=tt.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:Se(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return H||Y(this.status!==W.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,r){var n,i;try{for(var s=I(e.actions),o=s.next();!o.done;o=s.next()){var u=o.value;this.exec(u,e,r)}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},t.prototype.update=function(e,r){var n,i,s,o,u,c,h,a,f=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||r===Te)&&this.options.execute)this.execute(this.state);else for(var l=void 0;l=this._outgoingQueue.shift();)l[0].send(l[1]);if(this.children.forEach(function(M){f.state.children[M.id]=M}),this.devTools&&this.devTools.send(r.data,e),e.event)try{for(var p=I(this.eventListeners),v=p.next();!v.done;v=p.next()){var m=v.value;m(e.event)}}catch(M){n={error:M}}finally{try{v&&!v.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}try{for(var S=I(this.listeners),w=S.next();!w.done;w=S.next()){var m=w.value;m(e,e.event)}}catch(M){s={error:M}}finally{try{w&&!w.done&&(o=S.return)&&o.call(S)}finally{if(s)throw s.error}}try{for(var T=I(this.contextListeners),A=T.next();!A.done;A=T.next()){var C=A.value;C(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(M){u={error:M}}finally{try{A&&!A.done&&(c=T.return)&&c.call(T)}finally{if(u)throw u.error}}if(this.state.done){var O=e.configuration.find(function(M){return M.type==="final"&&M.parent===f.machine}),F=O&&O.doneData?We(O.doneData,e.context,r):void 0;try{for(var _=I(this.doneListeners),N=_.next();!N.done;N=_.next()){var m=N.value;m(Qe(this.id,F))}}catch(M){h={error:M}}finally{try{N&&!N.done&&(a=_.return)&&a.call(_)}finally{if(h)throw h.error}}this._stop(),this._stopChildren()}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===W.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,r,n){var i=this,s=Ye(e,r,n);this.listeners.add(s.next),this.status!==W.NotStarted&&s.next(this.state);var o=function(){i.doneListeners.delete(o),i.stopListeners.delete(o),s.complete()};return this.status===W.Stopped?s.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){i.listeners.delete(s.next),i.doneListeners.delete(o),i.stopListeners.delete(o)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var r=this;if(this.status===W.Running)return this;this.machine._init(),tt.register(this.sessionId,this),this.initialized=!0,this.status=W.Running;var n=e===void 0?this.initialState:Se(this,function(){return Ln(e)?r.machine.resolveState(e):r.machine.resolveState(se.from(e,r.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){r.update(n,Te)}),this},t.prototype._stopChildren=function(){this.children.forEach(function(e){j(e.stop)&&e.stop()}),this.children.clear()},t.prototype._stop=function(){var e,r,n,i,s,o,u,c,h,a;try{for(var f=I(this.listeners),l=f.next();!l.done;l=f.next()){var p=l.value;this.listeners.delete(p)}}catch(_){e={error:_}}finally{try{l&&!l.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}try{for(var v=I(this.stopListeners),m=v.next();!m.done;m=v.next()){var p=m.value;p(),this.stopListeners.delete(p)}}catch(_){n={error:_}}finally{try{m&&!m.done&&(i=v.return)&&i.call(v)}finally{if(n)throw n.error}}try{for(var S=I(this.contextListeners),w=S.next();!w.done;w=S.next()){var p=w.value;this.contextListeners.delete(p)}}catch(_){s={error:_}}finally{try{w&&!w.done&&(o=S.return)&&o.call(S)}finally{if(s)throw s.error}}try{for(var T=I(this.doneListeners),A=T.next();!A.done;A=T.next()){var p=A.value;this.doneListeners.delete(p)}}catch(_){u={error:_}}finally{try{A&&!A.done&&(c=T.return)&&c.call(T)}finally{if(u)throw u.error}}if(!this.initialized)return this;this.initialized=!1,this.status=W.Stopped,this._initialState=void 0;try{for(var C=I(Object.keys(this.delayedEventsMap)),O=C.next();!O.done;O=C.next()){var F=O.value;this.clock.clearTimeout(this.delayedEventsMap[F])}}catch(_){h={error:_}}finally{try{O&&!O.done&&(a=C.return)&&a.call(C)}finally{if(h)throw h.error}}this.scheduler.clear(),this.scheduler=new Tr({deferEvents:this.options.deferEvents})},t.prototype.stop=function(){var e=this,r=this.scheduler;return this._stop(),r.schedule(function(){var n=z({type:"xstate.stop"}),i=Se(e,function(){var s=G(V([],k(e.state.configuration),!1).sort(function(a,f){return f.order-a.order}).map(function(a){return he(a.onExit,e.machine.options.actions)})),o=k(Je(e.machine,e.state,e.state.context,n,[s],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),u=o[0],c=o[1],h=new se({value:e.state.value,context:c,_event:n,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:u.filter(function(a){return a.type!==me&&(a.type!==ge||!!a.to&&a.to!==le.Internal)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return h.changed=!0,h});e.update(i,n),e._stopChildren(),tt.free(e.sessionId)}),this},t.prototype.batch=function(e){var r=this;if(this.status===W.NotStarted&&this.options.deferEvents)H||Y(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,`" and are deferred. Make sure .start() is called for this service.
Event: `).concat(JSON.stringify(event)));else if(this.status!==W.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(e.length){var n=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var i,s,o=r.state,u=!1,c=[],h=function(p){var v=z(p);r.forward(v),o=Se(r,function(){return r.machine.transition(o,v,void 0,n||void 0)}),c.push.apply(c,V([],k(r.machine.config.predictableActionArguments?o.actions:o.actions.map(function(m){return jn(m,o)})),!1)),u=u||!!o.changed};try{for(var a=I(e),f=a.next();!f.done;f=a.next()){var l=f.value;h(l)}}catch(p){i={error:p}}finally{try{f&&!f.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}o.changed=u,o.actions=c,r.update(o,z(e[e.length-1]))})}},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype._nextState=function(e,r){var n=this;r===void 0&&(r=!!this.machine.config.predictableActionArguments&&this._exec);var i=z(e);if(i.name.indexOf(er)===0&&!this.state.nextEvents.some(function(o){return o.indexOf(er)===0}))throw i.data.data;var s=Se(this,function(){return n.machine.transition(n.state,i,void 0,r||void 0)});return s},t.prototype.nextState=function(e){return this._nextState(e,!1)},t.prototype.forward=function(e){var r,n;try{for(var i=I(this.forwardTo),s=i.next();!s.done;s=i.next()){var o=s.value,u=this.children.get(o);if(!u)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));u.send(e)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.defer=function(e){var r=this;this.delayedEventsMap[e.id]=this.clock.setTimeout(function(){e.to?r.sendTo(e._event,e.to,!0):r.send(e._event)},e.delay)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,r,n){n===void 0&&(n=this.machine.options.actions),this._exec(e,r.context,r._event,n)},t.prototype.removeChild=function(e){var r;this.children.delete(e),this.forwardTo.delete(e),(r=this.state)===null||r===void 0||delete r.children[e]},t.prototype.stopChild=function(e){var r=this.children.get(e);r&&(this.removeChild(e),j(r.stop)&&r.stop())},t.prototype.spawn=function(e,r,n){if(this.status!==W.Running)return vr(e,r);if(ar(e))return this.spawnPromise(Promise.resolve(e),r);if(j(e))return this.spawnCallback(e,r);if(Pn(e))return this.spawnActor(e,r);if(vn(e))return this.spawnObservable(e,r);if(ve(e))return this.spawnMachine(e,g(g({},n),{id:r}));if(hn(e))return this.spawnBehavior(e,r);throw new Error('Unable to spawn entity "'.concat(r,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,r){var n=this;r===void 0&&(r={});var i=new t(e,g(g({},this.options),{parent:this,id:r.id||e.id})),s=g(g({},Hn),r);s.sync&&i.onTransition(function(u){n.send(tr,{state:u,id:i.id})});var o=i;return this.children.set(i.id,o),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(u){n.removeChild(i.id),n.send(z(u,{origin:i.id}))}).start(),o},t.prototype.spawnBehavior=function(e,r){var n=Gn(e,{id:r,parent:this});return this.children.set(r,n),n},t.prototype.spawnPromise=function(e,r){var n,i=this,s=!1,o;e.then(function(c){s||(o=c,i.removeChild(r),i.send(z(Qe(r,c),{origin:r})))},function(c){if(!s){i.removeChild(r);var h=Ce(r,c);try{i.send(z(h,{origin:r}))}catch(a){gn(c,a,r),i.devTools&&i.devTools.send(h,i.state),i.machine.strict&&i.stop()}}});var u=(n={id:r,send:function(){},subscribe:function(c,h,a){var f=Ye(c,h,a),l=!1;return e.then(function(p){l||(f.next(p),!l&&f.complete())},function(p){l||f.error(p)}),{unsubscribe:function(){return l=!0}}},stop:function(){s=!0},toJSON:function(){return{id:r}},getSnapshot:function(){return o}},n[fe]=function(){return this},n);return this.children.set(r,u),u},t.prototype.spawnCallback=function(e,r){var n,i=this,s=!1,o=new Set,u=new Set,c,h=function(l){c=l,u.forEach(function(p){return p(l)}),!s&&i.send(z(l,{origin:r}))},a;try{a=e(h,function(l){o.add(l)})}catch(l){this.send(Ce(r,l))}if(ar(a))return this.spawnPromise(a,r);var f=(n={id:r,send:function(l){return o.forEach(function(p){return p(l)})},subscribe:function(l){var p=Ye(l);return u.add(p.next),{unsubscribe:function(){u.delete(p.next)}}},stop:function(){s=!0,j(a)&&a()},toJSON:function(){return{id:r}},getSnapshot:function(){return c}},n[fe]=function(){return this},n);return this.children.set(r,f),f},t.prototype.spawnObservable=function(e,r){var n,i=this,s,o=e.subscribe(function(c){s=c,i.send(z(c,{origin:r}))},function(c){i.removeChild(r),i.send(z(Ce(r,c),{origin:r}))},function(){i.removeChild(r),i.send(z(Qe(r),{origin:r}))}),u=(n={id:r,send:function(){},subscribe:function(c,h,a){return e.subscribe(c,h,a)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return s},toJSON:function(){return{id:r}}},n[fe]=function(){return this},n);return this.children.set(r,u),u},t.prototype.spawnActor=function(e,r){return this.children.set(r,e),e},t.prototype.spawnActivity=function(e){var r=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!r){H||Y(!1,"No implementation found for activity '".concat(e.type,"'"));return}var n=r(this.state.context,e);this.spawnEffect(e.id,n)},t.prototype.spawnEffect=function(e,r){var n;this.children.set(e,(n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:r||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},n[fe]=function(){return this},n))},t.prototype.attachDev=function(){var e=_t();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var r=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(g(g({name:this.id,autoPause:!0,stateSanitizer:function(n){return{value:n.value,context:n.context,actions:n.actions}}},r),{features:g({jump:!1,skip:!1},r?r.features:void 0)}),this.machine),this.devTools.init(this.state)}Bn(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[fe]=function(){return this},t.prototype.getSnapshot=function(){return this.status===W.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,r){return setTimeout(e,r)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},t.interpret=Ae,t}();function Ae(t,e){var r=new $n(t,e);return r}function qn(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function rt(t){return g(g({type:mt},t),{toJSON:function(){t.onDone,t.onError;var e=dt(t,["onDone","onError"]);return g(g({},e),{type:mt,src:qn(t.src)})}})}var be="",It="#",je="*",Re={},Oe=function(t){return t[0]===It},Wn=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},Yn=function(t,e,r){var n=r.slice(0,-1).some(function(s){return!("cond"in s)&&!("in"in s)&&(D(s.target)||ve(s.target))}),i=e===be?"the transient event":"event '".concat(e,"'");Y(!n,"One or more transitions for ".concat(i," on state '").concat(t.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")},zn=function(){function t(e,r,n,i){n===void 0&&(n="context"in e?e.context:void 0);var s=this,o;this.config=e,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(Wn(),r),this.parent=i==null?void 0:i.parent,this.key=this.config.key||(i==null?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:rr),this.id=this.config.id||V([this.machine.key],k(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(o=this.config.schema)!==null&&o!==void 0?o:{},this.description=this.config.description,H||Y(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?Pe(this.config.states,function(h,a){var f,l=new t(h,{},void 0,{parent:s,key:a});return Object.assign(s.idMap,g((f={},f[l.id]=l,f),l.idMap)),l}):Re;var u=0;function c(h){var a,f;h.order=u++;try{for(var l=I(yr(h)),p=l.next();!p.done;p=l.next()){var v=p.value;c(v)}}catch(m){a={error:m}}finally{try{p&&!p.done&&(f=l.return)&&f.call(l)}finally{if(a)throw a.error}}}c(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(h){var a=h.event;return a===be}):be in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=re(this.config.entry||this.config.onEntry).map(function(h){return De(h)}),this.onExit=re(this.config.exit||this.config.onExit).map(function(h){return De(h)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=re(this.config.invoke).map(function(h,a){var f,l;if(ve(h)){var p=ze(s.id,a);return s.machine.options.services=g((f={},f[p]=h,f),s.machine.options.services),rt({src:p,id:p})}else if(D(h.src)){var p=h.id||ze(s.id,a);return rt(g(g({},h),{id:p,src:h.src}))}else if(ve(h.src)||j(h.src)){var p=h.id||ze(s.id,a);return s.machine.options.services=g((l={},l[p]=h.src,l),s.machine.options.services),rt(g(g({id:p},h),{src:p}))}else{var v=h.src;return rt(g(g({id:ze(s.id,a)},h),{src:v}))}}),this.activities=re(this.config.activities).concat(this.invoke).map(function(h){return At(h)}),this.transition=this.transition.bind(this),this.tags=re(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||mr(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,r){var n=this.options,i=n.actions,s=n.activities,o=n.guards,u=n.services,c=n.delays;return new t(this.config,{actions:g(g({},i),e.actions),activities:g(g({},s),e.activities),guards:g(g({},o),e.guards),services:g(g({},u),e.services),delays:g(g({},c),e.delays)},r!=null?r:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return j(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:Pe(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(r,n){return r[n.eventType]=r[n.eventType]||[],r[n.eventType].push(n),r},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var r=e===be,n=this.transitions.filter(function(i){var s=i.eventType===e;return r?s:s||i.eventType===je});return this.__cache.candidates[e]=n,n},t.prototype.getDelayedTransitions=function(){var e=this,r=this.config.after;if(!r)return[];var n=function(s,o){var u=j(s)?"".concat(e.id,":delay[").concat(o,"]"):s,c=In(u,e.id);return e.onEntry.push(bt(c,{delay:s})),e.onExit.push(An(c)),c},i=Ee(r)?r.map(function(s,o){var u=n(s.delay,o);return g(g({},s),{event:u})}):G(Object.keys(r).map(function(s,o){var u=r[s],c=D(u)?{target:u}:u,h=isNaN(+s)?s:+s,a=n(h,o);return re(c).map(function(f){return g(g({},f),{event:a,delay:h})})}));return i.map(function(s){var o=s.delay;return g(g({},e.formatTransition(s)),{delay:o})})},t.prototype.getStateNodes=function(e){var r,n=this;if(!e)return[];var i=e instanceof se?e.value:Ne(e,this.delimiter);if(D(i)){var s=this.getStateNode(i).initial;return s!==void 0?this.getStateNodes((r={},r[i]=s,r)):[this,this.states[i]]}var o=Object.keys(i),u=[this];return u.push.apply(u,V([],k(G(o.map(function(c){return n.getStateNode(c).getStateNodes(i[c])}))),!1)),u},t.prototype.handles=function(e){var r=ir(e);return this.events.includes(r)},t.prototype.resolveState=function(e){var r=e instanceof se?e:se.create(e),n=Array.from(Ue([],this.getStateNodes(r.value)));return new se(g(g({},r),{value:this.resolve(r.value),configuration:n,done:et(n,this),tags:Er(n),machine:this.machine}))},t.prototype.transitionLeafNode=function(e,r,n){var i=this.getStateNode(e),s=i.next(r,n);return!s||!s.transitions.length?this.next(r,n):s},t.prototype.transitionCompoundNode=function(e,r,n){var i=Object.keys(e),s=this.getStateNode(i[0]),o=s._transition(e[i[0]],r,n);return!o||!o.transitions.length?this.next(r,n):o},t.prototype.transitionParallelNode=function(e,r,n){var i,s,o={};try{for(var u=I(Object.keys(e)),c=u.next();!c.done;c=u.next()){var h=c.value,a=e[h];if(a){var f=this.getStateNode(h),l=f._transition(a,r,n);l&&(o[h]=l)}}}catch(T){i={error:T}}finally{try{c&&!c.done&&(s=u.return)&&s.call(u)}finally{if(i)throw i.error}}var p=Object.keys(o).map(function(T){return o[T]}),v=G(p.map(function(T){return T.transitions})),m=p.some(function(T){return T.transitions.length>0});if(!m)return this.next(r,n);var S=G(p.map(function(T){return T.entrySet})),w=G(Object.keys(o).map(function(T){return o[T].configuration}));return{transitions:v,entrySet:S,exitSet:G(p.map(function(T){return T.exitSet})),configuration:w,source:r,actions:G(Object.keys(o).map(function(T){return o[T].actions}))}},t.prototype._transition=function(e,r,n){return D(e)?this.transitionLeafNode(e,r,n):Object.keys(e).length===1?this.transitionCompoundNode(e,r,n):this.transitionParallelNode(e,r,n)},t.prototype.getTransitionData=function(e,r){return this._transition(e.value,e,z(r))},t.prototype.next=function(e,r){var n,i,s=this,o=r.name,u=[],c=[],h;try{for(var a=I(this.getCandidates(o)),f=a.next();!f.done;f=a.next()){var l=f.value,p=l.cond,v=l.in,m=e.context,S=v?D(v)&&Oe(v)?e.matches(Ne(this.getStateNodeById(v).path,this.delimiter)):Et(Ne(v,this.delimiter),un(this.path.slice(0,-2))(e.value)):!0,w=!1;try{w=!p||fr(this.machine,p,m,r,e)}catch(O){throw new Error("Unable to evaluate guard '".concat(p.name||p.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(O.message))}if(w&&S){l.target!==void 0&&(c=l.target),u.push.apply(u,V([],k(l.actions),!1)),h=l;break}}}catch(O){n={error:O}}finally{try{f&&!f.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}if(h){if(!c.length)return{transitions:[h],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:u};var T=G(c.map(function(O){return s.getRelativeStateNodes(O,e.historyValue)})),A=!!h.internal,C=[];return A||c.forEach(function(O){C.push.apply(C,V([],k(s.getExternalReentryNodes(O)),!1))}),{transitions:[h],entrySet:C,exitSet:A?[]:[this],configuration:T,source:e,actions:u}}},t.prototype.getExternalReentryNodes=function(e){for(var r=[],n=k(e.order>this.order?[e,this]:[this,e],2),i=n[0],s=n[1];i&&i!==s;)r.push(i),i=i.parent;return i!==s?[]:(r.push(s),r)},t.prototype.getActions=function(e,r,n,i,s,o,u){var c,h,a,f,l=this,p=Ue([],o?this.getStateNodes(o.value):[this]);try{for(var v=I(e),m=v.next();!m.done;m=v.next()){var S=m.value;(!Le(p,S)||Le(n.entrySet,S.parent))&&n.entrySet.push(S)}}catch(b){c={error:b}}finally{try{m&&!m.done&&(h=v.return)&&h.call(v)}finally{if(c)throw c.error}}try{for(var w=I(p),T=w.next();!T.done;T=w.next()){var S=T.value;(!Le(e,S)||Le(n.exitSet,S.parent))&&n.exitSet.push(S)}}catch(b){a={error:b}}finally{try{T&&!T.done&&(f=w.return)&&f.call(w)}finally{if(a)throw a.error}}var A=G(n.entrySet.map(function(b){var x=[];if(b.type!=="final")return x;var J=b.parent;if(!J.parent)return x;x.push(Xe(b.id,b.doneData),Xe(J.id,b.doneData?We(b.doneData,i,s):void 0));var ee=J.parent;return ee.type==="parallel"&&Me(ee).every(function($){return et(n.configuration,$)})&&x.push(Xe(ee.id)),x}));n.exitSet.sort(function(b,x){return x.order-b.order}),n.entrySet.sort(function(b,x){return b.order-x.order});var C=new Set(n.entrySet),O=new Set(n.exitSet),F=Array.from(C).map(function(b){var x=b.onEntry,J=b.activities.map(function(ee){return bn(ee)});return he(u?V(V([],k(x),!1),k(J),!1):V(V([],k(J),!1),k(x),!1),l.machine.options.actions)}).concat([A.map(En)]),_=Array.from(O).map(function(b){return he(V(V([],k(b.onExit),!1),k(b.activities.map(function(x){return Rn(x)})),!1),l.machine.options.actions)}),N=_.concat([he(n.actions,this.machine.options.actions)]).concat(F);if(r){var M=he(G(V([],k(e),!1).sort(function(b,x){return x.order-b.order}).map(function(b){return b.onExit})),this.machine.options.actions).filter(function(b){return b.type!==me&&(b.type!==ge||!!b.to&&b.to!==le.Internal)});return N.concat([M])}return N},t.prototype.transition=function(e,r,n,i){e===void 0&&(e=this.initialState);var s=z(r),o;if(e instanceof se)o=n===void 0?e:this.resolveState(se.from(e,n));else{var u=D(e)?this.resolve($e(this.getResolvedPath(e))):this.resolve(e),c=n!=null?n:this.machine.context;o=this.resolveState(se.from(u,c))}if(!H&&s.name===je)throw new Error("An event cannot have the wildcard type ('".concat(je,"')"));if(this.strict&&!this.events.includes(s.name)&&!fn(s.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var h=this._transition(o.value,o,s)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:o,actions:[]},a=Ue([],this.getStateNodes(o.value)),f=h.configuration.length?Ue(a,h.configuration):a;return h.configuration=V([],k(f),!1),this.resolveTransition(h,o,o.context,i,s)},t.prototype.resolveRaisedTransition=function(e,r,n,i){var s,o=e.actions;return e=this.transition(e,r,void 0,i),e._event=n,e.event=n.data,(s=e.actions).unshift.apply(s,V([],k(o),!1)),e},t.prototype.resolveTransition=function(e,r,n,i,s){var o,u,c,h,a=this;s===void 0&&(s=Te);var f=e.configuration,l=!r||e.transitions.length>0,p=l?e.configuration:r?r.configuration:[],v=et(p,this),m=l?Cn(this.machine,f):void 0,S=r?r.historyValue?r.historyValue:e.source?this.machine.historyValue(r.value):void 0:void 0,w=this.getActions(new Set(p),v,e,n,s,r,i),T=r?g({},r.activities):{};try{for(var A=I(w),C=A.next();!C.done;C=A.next()){var O=C.value;try{for(var F=(c=void 0,I(O)),_=F.next();!_.done;_=F.next()){var N=_.value;N.type===pt?T[N.activity.id||N.activity.type]=N:N.type===vt&&(T[N.activity.id||N.activity.type]=!1)}}catch(Q){c={error:Q}}finally{try{_&&!_.done&&(h=F.return)&&h.call(F)}finally{if(c)throw c.error}}}}catch(Q){o={error:Q}}finally{try{C&&!C.done&&(u=A.return)&&u.call(A)}finally{if(o)throw o.error}}var M=k(Je(this,r,n,s,w,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),b=M[0],x=M[1],J=k(dn(b,function(Q){return Q.type===me||Q.type===ge&&Q.to===le.Internal}),2),ee=J[0],$=J[1],de=b.filter(function(Q){var q;return Q.type===pt&&((q=Q.activity)===null||q===void 0?void 0:q.type)===mt}),Fe=de.reduce(function(Q,q){return Q[q.activity.id]=xn(q.activity,a.machine,x,s),Q},r?g({},r.children):{}),d=new se({value:m||r.value,context:x,_event:s,_sessionid:r?r._sessionid:null,historyValue:m?S?pn(S,m):void 0:r?r.historyValue:void 0,history:!m||e.source?r:void 0,actions:m?$:[],activities:m?T:r?r.activities:{},events:[],configuration:p,transitions:e.transitions,children:Fe,done:v,tags:Er(p),machine:this}),y=n!==x;d.changed=s.name===tr||y;var R=d.history;R&&delete R.history;var K=!v&&(this._transient||f.some(function(Q){return Q._transient}));if(!l&&(!K||s.name===be))return d;var P=d;if(!v)for(K&&(P=this.resolveRaisedTransition(P,{type:tn},s,i));ee.length;){var U=ee.shift();P=this.resolveRaisedTransition(P,U._event,s,i)}var Ie=P.changed||(R?!!P.actions.length||y||typeof R.value!=typeof P.value||!wr(P.value,R.value):void 0);return P.changed=Ie,P.history=R,P},t.prototype.getStateNode=function(e){if(Oe(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var r=this.states[e];if(!r)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return r},t.prototype.getStateNodeById=function(e){var r=Oe(e)?e.slice(It.length):e;if(r===this.id)return this;var n=this.machine.idMap[r];if(!n)throw new Error("Child state node '#".concat(r,"' does not exist on machine '").concat(this.id,"'"));return n},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&Oe(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var r=wt(e,this.delimiter).slice(),n=this;r.length;){var i=r.shift();if(!i.length)break;n=n.getStateNode(i)}return n},t.prototype.resolve=function(e){var r,n=this;if(!e)return this.initialStateValue||Re;switch(this.type){case"parallel":return Pe(this.initialStateValue,function(s,o){return s?n.getStateNode(o).resolve(e[o]||s):Re});case"compound":if(D(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(r={},r[e]=i.initialStateValue,r):e}return Object.keys(e).length?Pe(e,function(s,o){return s?n.getStateNode(o).resolve(s):Re}):this.initialStateValue||{};default:return e||Re}},t.prototype.getResolvedPath=function(e){if(Oe(e)){var r=this.machine.idMap[e.slice(It.length)];if(!r)throw new Error("Unable to find state node '".concat(e,"'"));return r.path}return wt(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var r;if(this.type==="parallel")r=sr(this.states,function(n){return n.initialStateValue||Re},function(n){return n.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));r=Ze(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else r={};return this.__cache.initialStateValue=r,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,r){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,entrySet:V([],k(n),!1),exitSet:[],transitions:[],source:void 0,actions:[]},void 0,r!=null?r:this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var r=this.config;D(r.target)?e=Oe(r.target)?$e(this.machine.getStateNodeById(r.target).path.slice(this.path.length-1)):r.target:e=r.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,r,n){return n===void 0&&(n=!0),n?e.type==="history"?e.resolveHistory(r):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(Ze(this))return[this];if(this.type==="compound"&&!this.initial)return H||Y(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this];var r=qe(this.initialStateValue);return G(r.map(function(n){return e.getFromRelativePath(n)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var r=k(e),n=r[0],i=r.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var s=this.getStateNode(n);if(s.type==="history")return s.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},t.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:sr(this.states,function(r,n){if(!e)return r.historyValue();var i=D(e)?void 0:e[n];return r.historyValue(i||r.initialStateValue)},function(r){return!r.history})}},t.prototype.resolveHistory=function(e){var r=this;if(this.type!=="history")return[this];var n=this.parent;if(!e){var i=this.target;return i?G(qe(i).map(function(o){return n.getFromRelativePath(o)})):n.initialStateNodes}var s=ln(n.path,"states")(e).current;return D(s)?[n.getStateNode(s)]:G(qe(s).map(function(o){return r.history==="deep"?n.getFromRelativePath(o):[n.states[o[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,r=G(Object.keys(this.states).map(function(n){return e.states[n].stateIds}));return[this.id].concat(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,r,n,i;if(this.__cache.events)return this.__cache.events;var s=this.states,o=new Set(this.ownEvents);if(s)try{for(var u=I(Object.keys(s)),c=u.next();!c.done;c=u.next()){var h=c.value,a=s[h];if(a.states)try{for(var f=(n=void 0,I(a.events)),l=f.next();!l.done;l=f.next()){var p=l.value;o.add("".concat(p))}}catch(v){n={error:v}}finally{try{l&&!l.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}}}catch(v){e={error:v}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(r){return!(!r.target&&!r.actions.length&&r.internal)}).map(function(r){return r.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var r=this;if(e!==void 0)return e.map(function(n){if(!D(n))return n;var i=n[0]===r.delimiter;if(i&&!r.parent)return r.getStateNodeByPath(n.slice(1));var s=i?r.key+n:n;if(r.parent)try{var o=r.parent.getStateNodeByPath(s);return o}catch(u){throw new Error("Invalid transition definition for state node '".concat(r.id,`':
`).concat(u.message))}else return r.getStateNodeByPath(s)})},t.prototype.formatTransition=function(e){var r=this,n=mn(e.target),i="internal"in e?e.internal:n?n.some(function(c){return D(c)&&c[0]===r.delimiter}):!0,s=this.machine.options.guards,o=this.resolveTarget(n),u=g(g({},e),{actions:he(re(e.actions)),cond:lr(e.cond,s),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return g(g({},u),{target:u.target?u.target.map(function(c){return"#".concat(c.id)}):void 0,source:"#".concat(r.id)})}});return u},t.prototype.formatTransitions=function(){var e,r,n=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var s=this.config.on,o=je,u=s[o],c=u===void 0?[]:u,h=dt(s,[typeof o=="symbol"?o:o+""]);i=G(Object.keys(h).map(function(T){!H&&T===be&&Y(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(n.id,'".'));var A=we(T,h[T]);return H||Yn(n,T,A),A}).concat(we(je,c)))}var a=this.config.always?we("",this.config.always):[],f=this.config.onDone?we(String(Xe(this.id)),this.config.onDone):[];H||Y(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var l=G(this.invoke.map(function(T){var A=[];return T.onDone&&A.push.apply(A,V([],k(we(String(Qe(T.id)),T.onDone)),!1)),T.onError&&A.push.apply(A,V([],k(we(String(Ce(T.id)),T.onError)),!1)),A})),p=this.after,v=G(V(V(V(V([],k(f),!1),k(l),!1),k(i),!1),k(a),!1).map(function(T){return re(T).map(function(A){return n.formatTransition(A)})}));try{for(var m=I(p),S=m.next();!S.done;S=m.next()){var w=S.value;v.push(w)}}catch(T){e={error:T}}finally{try{S&&!S.done&&(r=m.return)&&r.call(m)}finally{if(e)throw e.error}}return v},t}(),Sr=!1;function _e(t,e){return!H&&!t.predictableActionArguments&&!Sr&&(Sr=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new zn(t,e)}var B=_n,Z=bt;const nt={user:null,mfa:null,accessToken:{value:null,expiresAt:null,expiresInSeconds:15},refreshTimer:{startedAt:null,attempts:0,lastAttempt:null},refreshToken:{value:null},importTokenAttempts:0,errors:{}};function Xn(t){return new TextEncoder().encode(t)}function ye(t){const e=new Uint8Array(t);let r="";for(const i of e)r+=String.fromCharCode(i);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function kt(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4,n=e.padEnd(e.length+r,"="),i=atob(n),s=new ArrayBuffer(i.length),o=new Uint8Array(s);for(let u=0;u<i.length;u++)o[u]=i.charCodeAt(u);return s}function Ar(){return(window==null?void 0:window.PublicKeyCredential)!==void 0&&typeof window.PublicKeyCredential=="function"}function br(t){const{id:e}=t;return{...t,id:kt(e),transports:t.transports}}function Rr(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}class X extends Error{constructor(e,r="WebAuthnError"){super(e),this.name=r}}function Qn({error:t,options:e}){var r,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal===new AbortController().signal)return new X("Registration ceremony was sent an abort signal","AbortError")}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new X("Discoverable credentials were required but no available authenticator supported it","ConstraintError");if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new X("User verification was required but no available authenticator supported it","ConstraintError")}else{if(t.name==="InvalidStateError")return new X("The authenticator was previously registered","InvalidStateError");if(t.name==="NotAllowedError")return new X("User clicked cancel, or the registration ceremony timed out","NotAllowedError");if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new X('No entry in pubKeyCredParams was of type "public-key"',"NotSupportedError"):new X("No available authenticator supported any of the specified pubKeyCredParams algorithms","NotSupportedError");if(t.name==="SecurityError"){const s=window.location.hostname;if(Rr(s)){if(i.rp.id!==s)return new X(`The RP ID "${i.rp.id}" is invalid for this domain`,"SecurityError")}else return new X(`${window.location.hostname} is an invalid domain`,"SecurityError")}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new X("User ID was not between 1 and 64 characters","TypeError")}else if(t.name==="UnknownError")return new X("The authenticator was unable to process the specified options, or could not create a new credential","UnknownError")}return t}class Jn{createNewAbortSignal(){return this.controller&&this.controller.abort(),this.controller=new AbortController,this.controller.signal}reset(){this.controller=void 0}}const it=new Jn;async function Or(t){if(!Ar())throw new Error("WebAuthn is not supported in this browser");const r={publicKey:{...t,challenge:kt(t.challenge),user:{...t.user,id:Xn(t.user.id)},excludeCredentials:t.excludeCredentials.map(br)}};r.signal=it.createNewAbortSignal();let n;try{n=await navigator.credentials.create(r)}catch(h){throw Qn({error:h,options:r})}finally{it.reset()}if(!n)throw new Error("Registration was not completed");const{id:i,rawId:s,response:o,type:u}=n,c={id:i,rawId:ye(s),response:{attestationObject:ye(o.attestationObject),clientDataJSON:ye(o.clientDataJSON)},type:u,clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:n.authenticatorAttachment};return typeof o.getTransports=="function"&&(c.transports=o.getTransports()),c}function Zn(t){return new TextDecoder("utf-8").decode(t)}async function ei(){if(navigator.credentials.conditionalMediationSupported)return!0;const t=window.PublicKeyCredential;return t.isConditionalMediationAvailable!==void 0&&t.isConditionalMediationAvailable()}function ti({error:t,options:e}){var r;const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal===new AbortController().signal)return new X("Authentication ceremony was sent an abort signal","AbortError")}else{if(t.name==="NotAllowedError")return!((r=n.allowCredentials)===null||r===void 0)&&r.length?new X("No available authenticator recognized any of the allowed credentials","NotAllowedError"):new X("User clicked cancel, or the authentication ceremony timed out","NotAllowedError");if(t.name==="SecurityError"){const i=window.location.hostname;if(Rr(i)){if(n.rpId!==i)return new X(`The RP ID "${n.rpId}" is invalid for this domain`,"SecurityError")}else return new X(`${window.location.hostname} is an invalid domain`,"SecurityError")}else if(t.name==="UnknownError")return new X("The authenticator was unable to process the specified options, or could not create a new assertion signature","UnknownError")}return t}async function ri(t,e=!1){var r,n;if(!Ar())throw new Error("WebAuthn is not supported in this browser");let i;((r=t.allowCredentials)===null||r===void 0?void 0:r.length)!==0&&(i=(n=t.allowCredentials)===null||n===void 0?void 0:n.map(br));const s={...t,challenge:kt(t.challenge),allowCredentials:i},o={};if(e){if(!await ei())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete*='webauthn']").length<1)throw Error('No <input> with `"webauthn"` in its `autocomplete` attribute was detected');o.mediation="conditional",s.allowCredentials=[]}o.publicKey=s,o.signal=it.createNewAbortSignal();let u;try{u=await navigator.credentials.get(o)}catch(p){throw ti({error:p,options:o})}finally{it.reset()}if(!u)throw new Error("Authentication was not completed");const{id:c,rawId:h,response:a,type:f}=u;let l;return a.userHandle&&(l=Zn(a.userHandle)),{id:c,rawId:ye(h),response:{authenticatorData:ye(a.authenticatorData),clientDataJSON:ye(a.clientDataJSON),signature:ye(a.signature),userHandle:l},type:f,clientExtensionResults:u.getClientExtensionResults(),authenticatorAttachment:u.authenticatorAttachment}}/*! js-cookie v3.0.1 | MIT */function st(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}var ni={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function xt(t,e){function r(i,s,o){if(typeof document!="undefined"){o=st({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var u="";for(var c in o)o[c]&&(u+="; "+c,o[c]!==!0&&(u+="="+o[c].split(";")[0]));return document.cookie=i+"="+t.write(s,i)+u}}function n(i){if(!(typeof document=="undefined"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],o={},u=0;u<s.length;u++){var c=s[u].split("="),h=c.slice(1).join("=");try{var a=decodeURIComponent(c[0]);if(o[a]=t.read(h,a),i===a)break}catch{}}return i?o[i]:o}}return Object.create({set:r,get:n,remove:function(i,s){r(i,"",st({},s,{expires:-1}))},withAttributes:function(i){return xt(this.converter,st({},this.attributes,i))},withConverter:function(i){return xt(st({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var Nt=xt(ni,{path:"/"});const ot=typeof window!="undefined",at=new Map,ii=t=>{var e;return ot&&typeof localStorage!="undefined"?localStorage.getItem(t):(e=at.get(t))!=null?e:null},si=(t,e)=>{ot&&typeof localStorage!="undefined"?e?localStorage.setItem(t,e):localStorage.removeItem(t):e?at.set(t,e):at.has(t)&&at.delete(t)},_r=(t,e)=>{if(t==="localStorage"||t==="web")return ii;if(t==="cookie")return r=>{var n;return ot&&(n=Nt.get(r))!=null?n:null};if(!e)throw Error(`clientStorageType is set to '${t}' but no clientStorage has been given`);if(t==="react-native")return r=>{var n;return(n=e.getItem)==null?void 0:n.call(e,r)};if(t==="capacitor")return r=>{var n;return(n=e.get)==null?void 0:n.call(e,{key:r})};if(t==="expo-secure-storage")return r=>{var n;return(n=e.getItemAsync)==null?void 0:n.call(e,r)};if(t==="custom"){if(e.getItem&&e.removeItem)return e.getItem;if(e.getItemAsync)return e.getItemAsync;throw Error(`clientStorageType is set to 'custom' but clientStorage is missing either "getItem" and "removeItem" properties or "getItemAsync" property`)}throw Error(`Unknown storage type: ${t}`)},Ir=(t,e)=>{if(t==="localStorage"||t==="web")return si;if(t==="cookie")return(r,n)=>{ot&&(n?Nt.set(r,n,{expires:30,sameSite:"lax",httpOnly:!1}):Nt.remove(r))};if(!e)throw Error(`clientStorageType is set to '${t}' but no clienStorage has been given`);if(t==="react-native")return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(t==="capacitor")return(r,n)=>{var i,s;return n?(i=e.set)==null?void 0:i.call(e,{key:r,value:n}):(s=e.remove)==null?void 0:s.call(e,{key:r})};if(t==="expo-secure-storage")return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.deleteItemAsync)==null?void 0:s.call(e,r)};if(t==="custom"){if(!e.removeItem)throw Error("clientStorageType is set to 'custom' but clientStorage is missing a removeItem property");if(e.setItem)return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(e.setItemAsync)return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};throw Error("clientStorageType is set to 'custom' but clientStorage is missing setItem or setItemAsync property")}throw Error(`Unknown storage type: ${t}`)},Ve=t=>!t||!t.accessToken.value||!t.accessToken.expiresAt||!t.user?null:{accessToken:t.accessToken.value,accessTokenExpiresIn:(t.accessToken.expiresAt.getTime()-Date.now())/1e3,refreshToken:t.refreshToken.value,user:t.user},ce=({accessToken:t,refreshToken:e,isError:r,user:n,error:i})=>r?{session:null,error:i}:n&&t?{session:{accessToken:t,accessTokenExpiresIn:0,refreshToken:e,user:n},error:null}:{session:null,error:null},ct=()=>typeof window!="undefined";var Pt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function oi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Dt={exports:{}};(function(t,e){(function(r){function n(i){var s=i&&i.Promise||r.Promise,o=i&&i.XMLHttpRequest||r.XMLHttpRequest;return function(){var u=Object.create(r,{fetch:{value:void 0,writable:!0}});return function(c,h){h(e)}(this,function(c){var h=typeof u!="undefined"&&u||typeof self!="undefined"&&self||typeof h!="undefined"&&h,a={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function f(d){return d&&DataView.prototype.isPrototypeOf(d)}if(a.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=ArrayBuffer.isView||function(d){return d&&l.indexOf(Object.prototype.toString.call(d))>-1};function v(d){if(typeof d!="string"&&(d=String(d)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(d)||d==="")throw new TypeError("Invalid character in header field name");return d.toLowerCase()}function m(d){return typeof d!="string"&&(d=String(d)),d}function S(d){var y={next:function(){var R=d.shift();return{done:R===void 0,value:R}}};return a.iterable&&(y[Symbol.iterator]=function(){return y}),y}function w(d){this.map={},d instanceof w?d.forEach(function(y,R){this.append(R,y)},this):Array.isArray(d)?d.forEach(function(y){this.append(y[0],y[1])},this):d&&Object.getOwnPropertyNames(d).forEach(function(y){this.append(y,d[y])},this)}w.prototype.append=function(d,y){d=v(d),y=m(y);var R=this.map[d];this.map[d]=R?R+", "+y:y},w.prototype.delete=function(d){delete this.map[v(d)]},w.prototype.get=function(d){return d=v(d),this.has(d)?this.map[d]:null},w.prototype.has=function(d){return this.map.hasOwnProperty(v(d))},w.prototype.set=function(d,y){this.map[v(d)]=m(y)},w.prototype.forEach=function(d,y){for(var R in this.map)this.map.hasOwnProperty(R)&&d.call(y,this.map[R],R,this)},w.prototype.keys=function(){var d=[];return this.forEach(function(y,R){d.push(R)}),S(d)},w.prototype.values=function(){var d=[];return this.forEach(function(y){d.push(y)}),S(d)},w.prototype.entries=function(){var d=[];return this.forEach(function(y,R){d.push([R,y])}),S(d)},a.iterable&&(w.prototype[Symbol.iterator]=w.prototype.entries);function T(d){if(d.bodyUsed)return s.reject(new TypeError("Already read"));d.bodyUsed=!0}function A(d){return new s(function(y,R){d.onload=function(){y(d.result)},d.onerror=function(){R(d.error)}})}function C(d){var y=new FileReader,R=A(y);return y.readAsArrayBuffer(d),R}function O(d){var y=new FileReader,R=A(y);return y.readAsText(d),R}function F(d){for(var y=new Uint8Array(d),R=new Array(y.length),K=0;K<y.length;K++)R[K]=String.fromCharCode(y[K]);return R.join("")}function _(d){if(d.slice)return d.slice(0);var y=new Uint8Array(d.byteLength);return y.set(new Uint8Array(d)),y.buffer}function N(){return this.bodyUsed=!1,this._initBody=function(d){this.bodyUsed=this.bodyUsed,this._bodyInit=d,d?typeof d=="string"?this._bodyText=d:a.blob&&Blob.prototype.isPrototypeOf(d)?this._bodyBlob=d:a.formData&&FormData.prototype.isPrototypeOf(d)?this._bodyFormData=d:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)?this._bodyText=d.toString():a.arrayBuffer&&a.blob&&f(d)?(this._bodyArrayBuffer=_(d.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(d)||p(d))?this._bodyArrayBuffer=_(d):this._bodyText=d=Object.prototype.toString.call(d):this._bodyText="",this.headers.get("content-type")||(typeof d=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var d=T(this);if(d)return d;if(this._bodyBlob)return s.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return s.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var d=T(this);return d||(ArrayBuffer.isView(this._bodyArrayBuffer)?s.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):s.resolve(this._bodyArrayBuffer))}else return this.blob().then(C)}),this.text=function(){var d=T(this);if(d)return d;if(this._bodyBlob)return O(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(F(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return s.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(J)}),this.json=function(){return this.text().then(JSON.parse)},this}var M=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(d){var y=d.toUpperCase();return M.indexOf(y)>-1?y:d}function x(d,y){if(!(this instanceof x))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');y=y||{};var R=y.body;if(d instanceof x){if(d.bodyUsed)throw new TypeError("Already read");this.url=d.url,this.credentials=d.credentials,y.headers||(this.headers=new w(d.headers)),this.method=d.method,this.mode=d.mode,this.signal=d.signal,!R&&d._bodyInit!=null&&(R=d._bodyInit,d.bodyUsed=!0)}else this.url=String(d);if(this.credentials=y.credentials||this.credentials||"same-origin",(y.headers||!this.headers)&&(this.headers=new w(y.headers)),this.method=b(y.method||this.method||"GET"),this.mode=y.mode||this.mode||null,this.signal=y.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&R)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(R),(this.method==="GET"||this.method==="HEAD")&&(y.cache==="no-store"||y.cache==="no-cache")){var K=/([?&])_=[^&]*/;if(K.test(this.url))this.url=this.url.replace(K,"$1_="+new Date().getTime());else{var P=/\?/;this.url+=(P.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}x.prototype.clone=function(){return new x(this,{body:this._bodyInit})};function J(d){var y=new FormData;return d.trim().split("&").forEach(function(R){if(R){var K=R.split("="),P=K.shift().replace(/\+/g," "),U=K.join("=").replace(/\+/g," ");y.append(decodeURIComponent(P),decodeURIComponent(U))}}),y}function ee(d){var y=new w,R=d.replace(/\r?\n[\t ]+/g," ");return R.split("\r").map(function(K){return K.indexOf(`
`)===0?K.substr(1,K.length):K}).forEach(function(K){var P=K.split(":"),U=P.shift().trim();if(U){var Ie=P.join(":").trim();y.append(U,Ie)}}),y}N.call(x.prototype);function $(d,y){if(!(this instanceof $))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');y||(y={}),this.type="default",this.status=y.status===void 0?200:y.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in y?y.statusText:"",this.headers=new w(y.headers),this.url=y.url||"",this._initBody(d)}N.call($.prototype),$.prototype.clone=function(){return new $(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},$.error=function(){var d=new $(null,{status:0,statusText:""});return d.type="error",d};var de=[301,302,303,307,308];$.redirect=function(d,y){if(de.indexOf(y)===-1)throw new RangeError("Invalid status code");return new $(null,{status:y,headers:{location:d}})},c.DOMException=h.DOMException;try{new c.DOMException}catch{c.DOMException=function(y,R){this.message=y,this.name=R;var K=Error(y);this.stack=K.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function Fe(d,y){return new s(function(R,K){var P=new x(d,y);if(P.signal&&P.signal.aborted)return K(new c.DOMException("Aborted","AbortError"));var U=new o;function Ie(){U.abort()}U.onload=function(){var q={status:U.status,statusText:U.statusText,headers:ee(U.getAllResponseHeaders()||"")};q.url="responseURL"in U?U.responseURL:q.headers.get("X-Request-URL");var lt="response"in U?U.response:U.responseText;setTimeout(function(){R(new $(lt,q))},0)},U.onerror=function(){setTimeout(function(){K(new TypeError("Network request failed"))},0)},U.ontimeout=function(){setTimeout(function(){K(new TypeError("Network request failed"))},0)},U.onabort=function(){setTimeout(function(){K(new c.DOMException("Aborted","AbortError"))},0)};function Q(q){try{return q===""&&h.location.href?h.location.href:q}catch{return q}}U.open(P.method,Q(P.url),!0),P.credentials==="include"?U.withCredentials=!0:P.credentials==="omit"&&(U.withCredentials=!1),"responseType"in U&&(a.blob?U.responseType="blob":a.arrayBuffer&&P.headers.get("Content-Type")&&P.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(U.responseType="arraybuffer")),y&&typeof y.headers=="object"&&!(y.headers instanceof w)?Object.getOwnPropertyNames(y.headers).forEach(function(q){U.setRequestHeader(q,m(y.headers[q]))}):P.headers.forEach(function(q,lt){U.setRequestHeader(lt,q)}),P.signal&&(P.signal.addEventListener("abort",Ie),U.onreadystatechange=function(){U.readyState===4&&P.signal.removeEventListener("abort",Ie)}),U.send(typeof P._bodyInit=="undefined"?null:P._bodyInit)})}Fe.polyfill=!0,h.fetch||(h.fetch=Fe,h.Headers=w,h.Request=x,h.Response=$),c.Headers=w,c.Request=x,c.Response=$,c.fetch=Fe,Object.defineProperty(c,"__esModule",{value:!0})}),{fetch:u.fetch,Headers:u.Headers,Request:u.Request,Response:u.Response,DOMException:u.DOMException}}()}t.exports=n})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:Pt)})(Dt,Dt.exports);var ai=Dt.exports;const ci=oi(ai);let kr=globalThis.fetch;typeof EdgeRuntime!="string"&&(kr=ci().fetch);const xr=async(t,e,{token:r,body:n}={})=>{const i={"Content-Type":"application/json",Accept:"*/*"};r&&(i.Authorization=`Bearer ${r}`);const s={method:e,headers:i};n&&(s.body=JSON.stringify(n));try{const o=await kr(t,s);if(!o.ok){const u=await o.json();return Promise.reject({error:u})}try{return{data:await o.json(),error:null}}catch{return console.warn(`Unexpected response: can't parse the response of the server at ${t}`),{data:"OK",error:null}}}catch{const u={message:"Network Error",status:0,error:"network"};return Promise.reject({error:u})}},oe=async(t,e,r)=>xr(t,"POST",{token:r,body:e}),Nr=(t,e)=>xr(t,"GET",{token:e}),Ct=(t,e)=>{const r=e&&Object.entries(e).map(([n,i])=>{const s=Array.isArray(i)?i.join(","):typeof i=="object"?JSON.stringify(i):i;return`${n}=${encodeURIComponent(s)}`}).join("&");return r?`${t}?${r}`:t},ne=(t,e)=>{if(!(e!=null&&e.redirectTo))return e;const{redirectTo:r,...n}=e;if(!t)return r.startsWith("/")?n:e;const i=new URL(t),s=Object.fromEntries(new URLSearchParams(i.search)),o=new URL(r.startsWith("/")?i.origin+r:r),u=new URLSearchParams(o.search);let c=Object.fromEntries(u);r.startsWith("/")&&(c={...s,...c});let h=i.pathname;return o.pathname.length>1&&(h+=o.pathname.slice(1)),{...n,redirectTo:Ct(o.origin+h,c)}};function Ke(t,e){var i;if(!e){if(typeof window=="undefined")return;e=((i=window.location)==null?void 0:i.href)||""}t=t.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+t+"(=([^&#]*)|&|#|$)"),n=r.exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function Mt(t){var r;if(typeof window=="undefined")return;const e=window==null?void 0:window.location;if(e&&e){const n=new URLSearchParams(e.search),i=new URLSearchParams((r=e.hash)==null?void 0:r.slice(1));n.delete(t),i.delete(t);let s=window.location.pathname;Array.from(n).length&&(s+=`?${n.toString()}`),Array.from(i).length&&(s+=`#${i.toString()}`),window.history.pushState({},"",s)}}const ue=t=>!!t&&typeof t=="string"&&!!String(t).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),ut=t=>!!t&&typeof t=="string"&&t.length>=3,Ut=t=>!!t&&typeof t=="string",Pr=t=>t&&typeof t=="string"&&t.match(/^mfaTotp:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),Dr=({backendUrl:t,clientUrl:e,clientStorageType:r="web",clientStorage:n,refreshIntervalTime:i,autoRefreshToken:s=!0,autoSignIn:o=!0})=>{const u=_r(r,n),c=Ir(r,n),h=async(a,f,l)=>(await oe(`${t}${a}`,f,l)).data;return _e({schema:{context:{},events:{},services:{}},tsTypes:{},context:nt,predictableActionArguments:!0,id:"nhost",type:"parallel",states:{authentication:{initial:"starting",on:{SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","resetTimer","reportTokenChanged"],target:".signedIn"}]},states:{starting:{tags:["loading"],always:{cond:"isSignedIn",target:"signedIn"},invoke:{id:"importRefreshToken",src:"importRefreshToken",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"signedIn"},{target:"signedOut"}],onError:[{cond:"shouldRetryImportToken",actions:"incrementTokenImportAttempts",target:"retryTokenImport"},{actions:["saveAuthenticationError"],target:"signedOut"}]}},retryTokenImport:{tags:["loading"],after:{RETRY_IMPORT_TOKEN_DELAY:"starting"}},signedOut:{initial:"noErrors",entry:"reportSignedOut",states:{noErrors:{},success:{},needsSmsOtp:{},needsMfa:{},failed:{},signingOut:{entry:["clearContextExceptRefreshToken"],exit:["destroyRefreshToken","reportTokenChanged"],invoke:{src:"signout",id:"signingOut",onDone:{target:"success"},onError:{target:"failed",actions:["saveAuthenticationError"]}}}},on:{SIGNIN_PASSWORD:"authenticating.password",SIGNIN_ANONYMOUS:"authenticating.anonymous",SIGNIN_SECURITY_KEY_EMAIL:"authenticating.securityKeyEmail",SIGNIN_MFA_TOTP:"authenticating.mfa.totp",SIGNIN_PAT:"authenticating.pat"}},authenticating:{entry:"resetErrors",states:{password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:[{cond:"hasMfaTicket",actions:["saveMfaTicket"],target:"#nhost.authentication.signedOut.needsMfa"},{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"}],onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},pat:{invoke:{src:"signInPAT",id:"authenticateWithPAT",onDone:{actions:["savePATSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},mfa:{states:{totp:{invoke:{src:"signInMfaTotp",id:"signInMfaTotp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:["saveAuthenticationError"],target:"#nhost.authentication.signedOut.failed"}}}}},securityKeyEmail:{invoke:{src:"signInSecurityKeyEmail",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}}}},signedIn:{type:"parallel",entry:["reportSignedIn","cleanUrl","broadcastToken","resetErrors"],on:{SIGNOUT:"signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"isRefreshTokenPAT",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{1e3:{internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","resetTimer","reportTokenChanged"],target:"pending"},onError:[{actions:"saveRefreshAttempt",target:"pending"}]}}}}}}}}}},token:{initial:"idle",states:{idle:{on:{TRY_TOKEN:"running"},initial:"noErrors",states:{noErrors:{},error:{}}},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","reportTokenChanged"],target:["#nhost.authentication.signedIn","idle.noErrors"]},onError:[{cond:"isSignedIn",target:"idle.error"},{actions:"saveAuthenticationError",target:["#nhost.authentication.signedOut.failed","idle.error"]}]}}}},registration:{initial:"incomplete",on:{SIGNED_IN:[{cond:"isAnonymous",target:".incomplete"},".complete"]},states:{incomplete:{on:{SIGNUP_EMAIL_PASSWORD:"emailPassword",SIGNUP_SECURITY_KEY:"securityKey",PASSWORDLESS_EMAIL:"passwordlessEmail",PASSWORDLESS_SMS:"passwordlessSms",PASSWORDLESS_SMS_OTP:"passwordlessSmsOtp"},initial:"noErrors",states:{noErrors:{},needsEmailVerification:{},needsOtp:{},failed:{}}},emailPassword:{entry:["resetErrors"],invoke:{src:"signUpEmailPassword",id:"signUpEmailPassword",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},securityKey:{entry:["resetErrors"],invoke:{src:"signUpSecurityKey",id:"signUpSecurityKey",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},passwordlessEmail:{entry:["resetErrors"],invoke:{src:"passwordlessEmail",id:"passwordlessEmail",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSms:{entry:["resetErrors"],invoke:{src:"passwordlessSms",id:"passwordlessSms",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSmsOtp:{entry:["resetErrors"],invoke:{src:"passwordlessSmsOtp",id:"passwordlessSmsOtp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},complete:{on:{SIGNED_OUT:"incomplete"}}}}}},{actions:{reportSignedIn:Z("SIGNED_IN"),reportSignedOut:Z("SIGNED_OUT"),reportTokenChanged:Z("TOKEN_CHANGED"),incrementTokenImportAttempts:B({importTokenAttempts:({importTokenAttempts:a})=>a+1}),clearContext:B(()=>(c(pe,null),c(ie,null),c(ke,null),{...nt})),clearContextExceptRefreshToken:B(({refreshToken:{value:a}})=>(c(pe,null),{...nt,refreshToken:{value:a}})),saveSession:B({user:(a,{data:f})=>{var l;return((l=f==null?void 0:f.session)==null?void 0:l.user)||null},accessToken:(a,{data:f})=>{if(f.session){const{accessTokenExpiresIn:l,accessToken:p}=f.session,v=new Date(Date.now()+l*1e3);return c(pe,v.toISOString()),{value:p,expiresAt:v,expiresInSeconds:l}}return c(pe,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(a,{data:f})=>{var v,m;const l=((v=f.session)==null?void 0:v.refreshToken)||null,p=((m=f.session)==null?void 0:m.refreshTokenId)||null;return l&&c(ie,l),p&&c(ke,p),{value:l}}}),savePATSession:B({user:(a,{data:f})=>{var l;return((l=f==null?void 0:f.session)==null?void 0:l.user)||null},accessToken:(a,{data:f})=>{if(f.session){const{accessTokenExpiresIn:l,accessToken:p}=f.session,v=new Date(Date.now()+l*1e3);return c(pe,v.toISOString()),{value:p,expiresAt:v,expiresInSeconds:l}}return c(pe,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(a,{data:f})=>{var v,m;const l=((v=f.session)==null?void 0:v.refreshToken)||null,p=((m=f.session)==null?void 0:m.refreshTokenId)||null;return l&&c(ie,l),p&&c(ke,p),{value:l,isPAT:!0}}}),saveMfaTicket:B({mfa:(a,f)=>{var l;return(l=f.data)==null?void 0:l.mfa}}),resetTimer:B({refreshTimer:a=>({startedAt:new Date,attempts:0,lastAttempt:null})}),saveRefreshAttempt:B({refreshTimer:(a,f)=>({startedAt:a.refreshTimer.startedAt,attempts:a.refreshTimer.attempts+1,lastAttempt:new Date})}),saveAuthenticationError:B({errors:({errors:a},{data:{error:f}})=>({...a,authentication:f})}),resetErrors:B({errors:a=>({}),importTokenAttempts:a=>0}),saveRegistrationError:B({errors:({errors:a},{data:{error:f}})=>({...a,registration:f})}),destroyRefreshToken:B({refreshToken:a=>(c(ie,null),c(ke,null),{value:null})}),cleanUrl:()=>{o&&Ke("refreshToken")&&(Mt("refreshToken"),Mt("type"))},broadcastToken:a=>{if(o)try{new BroadcastChannel("nhost").postMessage(a.refreshToken.value)}catch{}}},guards:{isAnonymous:(a,f)=>{var l;return!!((l=a.user)!=null&&l.isAnonymous)},isSignedIn:a=>!!a.user&&!!a.accessToken.value,noToken:a=>!a.refreshToken.value,isRefreshTokenPAT:a=>{var f;return!!((f=a.refreshToken)!=null&&f.isPAT)},hasRefreshToken:a=>!!a.refreshToken.value,isAutoRefreshDisabled:()=>!s,refreshTimerShouldRefresh:a=>{const{expiresAt:f}=a.accessToken;if(!f)return!1;if(a.refreshTimer.lastAttempt)return a.refreshTimer.attempts>5?!1:Date.now()-a.refreshTimer.lastAttempt.getTime()>Math.pow(2,a.refreshTimer.attempts-1)*5e3;if(i&&Date.now()-a.refreshTimer.startedAt.getTime()>i*1e3)return!0;const l=a.accessToken.expiresInSeconds;return l?f.getTime()-Date.now()-1e3*Math.min(60,l*.5)<=0:!1},shouldRetryImportToken:(a,f)=>a.importTokenAttempts<5&&(f.data.error.status===0||f.data.error.status>=500),unverified:(a,{data:{error:f}})=>f.status===401&&(f.message==="Email is not verified"||f.error==="unverified-user"),hasSession:(a,f)=>{var l;return!!((l=f.data)!=null&&l.session)},hasMfaTicket:(a,f)=>{var l;return!!((l=f.data)!=null&&l.mfa)}},services:{signInPassword:(a,{email:f,password:l})=>ue(f)?ut(l)?h("/signin/email-password",{email:f,password:l}):Promise.reject({error:Be}):Promise.reject({error:ae}),signInPAT:(a,{pat:f})=>h("/signin/pat",{personalAccessToken:f}),passwordlessSms:(a,{phoneNumber:f,options:l})=>{var p;return Ut(f)?(p=a.user)!=null&&p.isAnonymous?(console.warn("Deanonymisation from a phone number is not yet implemented in hasura-auth"),h("/user/deanonymize",{signInMethod:"passwordless",connection:"sms",phoneNumber:f,options:ne(e,l)},a.accessToken.value)):h("/signin/passwordless/sms",{phoneNumber:f,options:ne(e,l)}):Promise.reject({error:ft})},passwordlessSmsOtp:(a,{phoneNumber:f,otp:l})=>Ut(f)?h("/signin/passwordless/sms/otp",{phoneNumber:f,otp:l}):Promise.reject({error:ft}),passwordlessEmail:(a,{email:f,options:l})=>{var p;return ue(f)?(p=a.user)!=null&&p.isAnonymous?h("/user/deanonymize",{signInMethod:"passwordless",connection:"email",email:f,options:ne(e,l)},a.accessToken.value):h("/signin/passwordless/email",{email:f,options:ne(e,l)}):Promise.reject({error:ae})},signInAnonymous:a=>h("/signin/anonymous"),signInMfaTotp:(a,f)=>{var p;const l=f.ticket||((p=a.mfa)==null?void 0:p.ticket);return l?Pr(l)?h("/signin/mfa/totp",{ticket:l,otp:f.otp}):Promise.reject({error:Gt}):Promise.reject({error:Ht})},signInSecurityKeyEmail:async(a,{email:f})=>{if(!ue(f))throw new xe(ae);const l=await h("/signin/webauthn",{email:f});let p;try{p=await ri(l)}catch(v){throw new xe(v)}return h("/signin/webauthn/verify",{email:f,credential:p})},refreshToken:async(a,f)=>{const l=f.type==="TRY_TOKEN"?f.token:a.refreshToken.value;return{session:await h("/token",{refreshToken:l}),error:null}},signout:(a,f)=>h("/signout",{refreshToken:a.refreshToken.value,all:!!f.all}),signUpEmailPassword:async(a,{email:f,password:l,options:p})=>{var v;return ue(f)?ut(l)?(v=a.user)!=null&&v.isAnonymous?h("/user/deanonymize",{signInMethod:"email-password",email:f,password:l,options:ne(e,p)},a.accessToken.value):h("/signup/email-password",{email:f,password:l,options:ne(e,p)}):Promise.reject({error:Be}):Promise.reject({error:ae})},signUpSecurityKey:async(a,{email:f,options:l})=>{if(!ue(f))return Promise.reject({error:ae});const p=l==null?void 0:l.nickname;p&&delete l.nickname;const v=await h("/signup/webauthn",{email:f,options:l});let m;try{m=await Or(v)}catch(S){throw new xe(S)}return h("/signup/webauthn/verify",{credential:m,options:{redirectTo:l==null?void 0:l.redirectTo,nickname:p}})},importRefreshToken:async a=>{if(a.user&&a.refreshToken.value&&a.accessToken.value&&a.accessToken.expiresAt)return{session:{accessToken:a.accessToken.value,accessTokenExpiresIn:a.accessToken.expiresAt.getTime()-Date.now(),refreshToken:a.refreshToken.value,user:a.user},error:null};let f=null;if(o){const p=Ke("refreshToken")||null;if(p)try{return{session:await h("/token",{refreshToken:p}),error:null}}catch(v){f=v.error}else{const v=Ke("error");if(v)return Promise.reject({session:null,error:{status:10,error:v,message:Ke("errorDescription")||v}})}}const l=await u(ie);if(l)try{return{session:await h("/token",{refreshToken:l}),error:null}}catch(p){f=p.error}return f?Promise.reject({error:f,session:null}):{error:null,session:null}}},delays:{RETRY_IMPORT_TOKEN_DELAY:({importTokenAttempts:a})=>Math.pow(2,a-1)*5e3}})},Cr=({backendUrl:t,clientUrl:e,interpreter:r})=>_e({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:B({error:n=>ae}),saveRequestError:B({error:(n,{data:{error:i}})=>i}),reportError:Z(n=>({type:"ERROR",error:n.error})),reportSuccess:Z("SUCCESS")},guards:{invalidEmail:(n,{email:i})=>!ue(i)},services:{requestChange:async(n,{email:i,options:s})=>(await oe(`${t}/user/email/change`,{newEmail:i,options:ne(e,s)},r==null?void 0:r.getSnapshot().context.accessToken.value)).data}}),Mr=({backendUrl:t,interpreter:e})=>_e({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:B({error:r=>Be}),saveRequestError:B({error:(r,{data:{error:n}})=>n}),reportError:Z(r=>({type:"ERROR",error:r.error})),reportSuccess:Z("SUCCESS")},guards:{invalidPassword:(r,{password:n})=>!ut(n)},services:{requestChange:(r,{password:n,ticket:i})=>oe(`${t}/user/password`,{newPassword:n,ticket:i},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),ui=({backendUrl:t,interpreter:e})=>_e({schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,id:"enableMfa",initial:"idle",context:{error:null,imageUrl:null,secret:null},states:{idle:{initial:"initial",on:{GENERATE:"generating"},states:{initial:{},error:{}}},generating:{invoke:{src:"generate",id:"generate",onDone:{target:"generated",actions:["reportGeneratedSuccess","saveGeneration"]},onError:{actions:["saveError","reportGeneratedError"],target:"idle.error"}}},generated:{initial:"idle",states:{idle:{initial:"idle",on:{ACTIVATE:[{cond:"invalidMfaType",actions:"saveInvalidMfaTypeError",target:".error"},{cond:"invalidMfaCode",actions:"saveInvalidMfaCodeError",target:".error"},{target:"activating"}]},states:{idle:{},error:{}}},activating:{invoke:{src:"activate",id:"activate",onDone:{target:"activated",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}},activated:{type:"final"}}}}},{actions:{saveInvalidMfaTypeError:B({error:r=>Ft}),saveInvalidMfaCodeError:B({error:r=>Bt}),saveError:B({error:(r,{data:{error:n}})=>n}),saveGeneration:B({imageUrl:(r,{data:{imageUrl:n}})=>n,secret:(r,{data:{totpSecret:n}})=>n}),reportError:Z((r,n)=>(console.log("REPORT",r,n),{type:"ERROR",error:r.error})),reportSuccess:Z("SUCCESS"),reportGeneratedSuccess:Z("GENERATED"),reportGeneratedError:Z(r=>({type:"GENERATED_ERROR",error:r.error}))},guards:{invalidMfaCode:(r,{code:n})=>!n,invalidMfaType:(r,{activeMfaType:n})=>!n||n!=="totp"},services:{generate:async r=>{const{data:n}=await Nr(`${t}/mfa/totp/generate`,e==null?void 0:e.getSnapshot().context.accessToken.value);return n},activate:(r,{code:n,activeMfaType:i})=>oe(`${t}/user/mfa`,{code:n,activeMfaType:i},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),Ur=({backendUrl:t,clientUrl:e})=>_e({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:B({error:r=>ae}),saveRequestError:B({error:(r,{data:{error:n}})=>n}),reportError:Z(r=>({type:"ERROR",error:r.error})),reportSuccess:Z("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!ue(n)},services:{requestChange:(r,{email:n,options:i})=>oe(`${t}/user/password/reset`,{email:n,options:ne(e,i)})}}),Lr=({backendUrl:t,clientUrl:e})=>_e({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"sendVerificationEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"request",id:"request",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:B({error:r=>ae}),saveRequestError:B({error:(r,{data:{error:n}})=>n}),reportError:Z(r=>({type:"ERROR",error:r.error})),reportSuccess:Z("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!ue(n)},services:{request:async(r,{email:n,options:i})=>(await oe(`${t}/user/email/send-verification-email`,{email:n,options:ne(e,i)})).data}});class Lt{constructor({clientStorageType:e="web",autoSignIn:r=!0,autoRefreshToken:n=!0,start:i=!0,backendUrl:s,clientUrl:o,devTools:u,...c}){if(this._started=!1,this._subscriptionsQueue=new Set,this._subscriptions=new Set,this.backendUrl=s,this.clientUrl=o,this._machine=Dr({...c,backendUrl:s,clientUrl:o,clientStorageType:e,autoSignIn:r,autoRefreshToken:n}),i&&this.start({devTools:u}),typeof window!="undefined"&&r)try{this._channel=new BroadcastChannel("nhost"),this._channel.addEventListener("message",h=>{var f;const a=(f=this.interpreter)==null?void 0:f.getSnapshot().context.refreshToken.value;this.interpreter&&h.data!==a&&this.interpreter.send("TRY_TOKEN",{token:h.data})})}catch{}}start({devTools:e=!1,initialSession:r,interpreter:n}={}){var o,u;const i={...this.machine.context};r&&(i.user=r.user,i.refreshToken.value=(o=r.refreshToken)!=null?o:null,i.accessToken.value=(u=r.accessToken)!=null?u:null,i.accessToken.expiresAt=new Date(Date.now()+r.accessTokenExpiresIn*1e3));const s=this.machine.withContext(i);this._interpreter||(this._interpreter=n||Ae(s,{devTools:e})),(!this._started||typeof window=="undefined")&&(this._interpreter.initialized&&(this._interpreter.stop(),this._subscriptions.forEach(c=>c())),this._interpreter.start(s.initialState),this._subscriptionsQueue.forEach(c=>c(this))),this._started=!0}get machine(){return this._machine}get interpreter(){return this._interpreter}get started(){return this._started}subscribe(e){if(this.started){const r=e(this);return this._subscriptions.add(r),r}else return this._subscriptionsQueue.add(e),()=>{console.log("onTokenChanged was added before the interpreter started. Cannot unsubscribe listener.")}}}class jr extends Lt{constructor({...e}){super({...e,autoSignIn:ct()&&e.autoSignIn,autoRefreshToken:ct()&&e.autoRefreshToken,clientStorageType:"cookie"})}}const li=jr,Vr=async({backendUrl:t,interpreter:e},r)=>{try{const{data:n}=await oe(`${t}/user/webauthn/add`,{},e==null?void 0:e.getSnapshot().context.accessToken.value);let i;try{i=await Or(n)}catch(o){throw new xe(o)}const{data:s}=await oe(`${t}/user/webauthn/verify`,{credential:i,nickname:r},e==null?void 0:e.getSnapshot().context.accessToken.value);return{key:s,isError:!1,error:null,isSuccess:!0}}catch(n){const{error:i}=n;return{isError:!0,error:i,isSuccess:!1}}},Kr=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,needsEmailVerification:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,needsEmailVerification:!0})})}),Fr=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{password:e,ticket:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSuccess:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSuccess:!0})})}),fi=t=>new Promise(e=>{t.send("GENERATE"),t.onTransition(r=>{r.matches("generated")?e({error:null,isError:!1,isGenerated:!0,qrCodeDataUrl:r.context.imageUrl||""}):r.matches({idle:"error"})&&e({error:r.context.error||null,isError:!0,isGenerated:!1,qrCodeDataUrl:""})})}),hi=(t,e)=>new Promise(r=>{t.send("ACTIVATE",{activeMfaType:"totp",code:e}),t.onTransition(n=>{n.matches({generated:"activated"})?r({error:null,isActivated:!0,isError:!1}):n.matches({generated:{idle:"error"}})&&r({error:n.context.error,isActivated:!1,isError:!0})})}),Br=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),Gr=(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),Hr=t=>new Promise(e=>{const{changed:r}=t.send("SIGNIN_ANONYMOUS");r||e({isSuccess:!1,isError:!0,error:te,user:null,accessToken:null,refreshToken:null}),t.onTransition(n=>{n.matches({authentication:"signedIn"})&&e({isSuccess:!0,isError:!1,error:null,user:n.context.user,accessToken:n.context.accessToken.value,refreshToken:n.context.refreshToken.value}),n.matches({authentication:{signedOut:"failed"}})&&e({isSuccess:!1,isError:!0,error:n.context.errors.authentication||null,user:null,accessToken:null,refreshToken:null})})}),$r=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_PASSWORD",{email:e,password:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:te,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:{signedOut:"needsMfa"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!0,mfa:o.context.mfa,user:null}):o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:o.context.user})})}),jt=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_EMAIL",{email:e,options:r});if(!i)return n({error:te,isError:!0,isSuccess:!1});t.onTransition(s=>{s.matches("registration.incomplete.failed")?n({error:s.context.errors.registration||null,isError:!0,isSuccess:!1}):s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})&&n({error:null,isError:!1,isSuccess:!0})})}),qr=(t,e)=>new Promise(r=>{const{changed:n,context:i}=t.send({type:"SIGNIN_SECURITY_KEY_EMAIL",email:e});if(!n)return r({accessToken:i.accessToken.value,refreshToken:i.refreshToken.value,error:te,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:i.user});t.onTransition(s=>{s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?r({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):s.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,refreshToken:null,error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):s.matches({authentication:"signedIn"})&&r({accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:s.context.user})})}),Wr=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_MFA_TOTP",{otp:e,ticket:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:te,isError:!0,isSuccess:!1,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,user:o.context.user})})}),Yr=(t,e)=>new Promise(r=>{const{changed:n}=t.send("SIGNIN_PAT",{pat:e});n||r({isSuccess:!1,isError:!0,error:te,user:null,accessToken:null,refreshToken:null}),t.onTransition(i=>{if(i.matches({authentication:{signedOut:"failed"}}))return r({accessToken:null,refreshToken:null,user:null,error:i.context.errors.authentication||null,isError:!0,isSuccess:!1});if(i.matches({authentication:"signedIn"}))return r({accessToken:i.context.accessToken.value,refreshToken:i.context.refreshToken.value,user:i.context.user,error:null,isError:!1,isSuccess:!0})})}),Vt=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_SMS",{phoneNumber:e,options:r});if(!i)return n({error:te,isError:!0,isSuccess:!1,needsOtp:!1});t.onTransition(s=>{s.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!1,needsOtp:!0}):s.matches("registration.incomplete.failed")&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),zr=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send({type:"PASSWORDLESS_SMS_OTP",phoneNumber:e,otp:r});if(!i)return n({error:te,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});t.onTransition(s=>{s.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:s.context.user,accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value}):s.matches({registration:{incomplete:"failed"}})&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),Xr=async(t,e)=>new Promise(r=>{const{event:n}=t.send("SIGNOUT",{all:e});if(n.type!=="SIGNED_OUT")return r({isSuccess:!1,isError:!0,error:Wt});t.onTransition(i=>{i.matches({authentication:{signedOut:"success"}})?r({isSuccess:!0,isError:!1,error:null}):i.matches("authentication.signedOut.failed")&&r({isSuccess:!1,isError:!0,error:i.context.errors.signout||null})})}),Kt=(t,e,r,n)=>new Promise(i=>{const{changed:s,context:o}=t.send("SIGNUP_EMAIL_PASSWORD",{email:e,password:r,options:n});if(!s)return i({error:te,accessToken:o.accessToken.value,refreshToken:o.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:o.user});t.onTransition(u=>{u.matches("registration.incomplete.failed")?i({accessToken:null,refreshToken:null,error:u.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):u.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?i({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):u.matches({authentication:"signedIn",registration:"complete"})&&i({accessToken:u.context.accessToken.value,refreshToken:u.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:u.context.user})})}),Qr=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNUP_SECURITY_KEY",{email:e,options:r});if(!i)return n({error:te,accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:s.user});t.onTransition(o=>{o.matches("registration.incomplete.failed")?n({accessToken:null,refreshToken:null,error:o.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):o.matches({authentication:"signedIn",registration:"complete"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:o.context.user})})}),di=async({backendUrl:t,interpreter:e},{expiresAt:r,metadata:n})=>{try{const{data:i}=await oe(`${t}/pat`,{expiresAt:r.toUTCString(),metadata:n},e==null?void 0:e.getSnapshot().context.accessToken.value);return{data:i?{id:i.id||null,personalAccessToken:i.personalAccessToken||null}:null,isError:!1,error:null,isSuccess:!0}}catch(i){const{error:s}=i;return{isError:!0,error:s,isSuccess:!1,data:null}}};class pi{constructor({url:e,autoRefreshToken:r=!0,autoSignIn:n=!0,clientStorage:i,clientStorageType:s,refreshIntervalTime:o,start:u=!0}){var c;this.url=e,this._client=new Lt({backendUrl:e,clientUrl:typeof window!="undefined"&&((c=window.location)==null?void 0:c.origin)||"",autoRefreshToken:r,autoSignIn:n,start:u,clientStorage:i,clientStorageType:s,refreshIntervalTime:o})}async signUp(e){const r=await this.waitUntilReady(),{email:n,options:i}=e;return"securityKey"in e?ce(await Qr(r,n,i)):ce(await Kt(r,n,e.password,i))}async signIn(e){const r=await this.waitUntilReady();if(!e){const n=await Hr(r);return{...ce(n),mfa:null}}if("provider"in e){const{provider:n,options:i}=e,s=Ct(`${this._client.backendUrl}/signin/provider/${n}`,ne(this._client.clientUrl,i));return ct()&&(window.location.href=s),{providerUrl:s,provider:n,session:null,mfa:null,error:null}}if("email"in e&&"password"in e){const n=await $r(r,e.email,e.password);return n.needsEmailVerification?{session:null,mfa:null,error:Yt}:n.needsMfaOtp?{session:null,mfa:n.mfa,error:null}:{...ce(n),mfa:null}}if("email"in e&&"securityKey"in e){if(e.securityKey!==!0)throw Error("securityKey must be true");const n=await qr(r,e.email);return{...ce(n),mfa:null}}if("email"in e){const{email:n,options:i}=e,{error:s}=await jt(r,n,i);return{session:null,mfa:null,error:s}}if("phoneNumber"in e&&"otp"in e){const n=await zr(r,e.phoneNumber,e.otp);return{...ce(n),mfa:null}}if("phoneNumber"in e){const{error:n}=await Vt(r,e.phoneNumber,e.options);return{error:n,mfa:null,session:null}}if("otp"in e){const n=await Wr(r,e.otp,e.ticket);return{...ce(n),mfa:null}}return{error:Xt,mfa:null,session:null}}async signInPAT(e){const r=await this.waitUntilReady(),n=await Yr(r,e);return ce(n)}async signOut(e){const r=await this.waitUntilReady(),{error:n}=await Xr(r,e==null?void 0:e.all);return{error:n}}async resetPassword({email:e,options:r}){const n=Ae(Ur(this._client)).start(),{error:i}=await Br(n,e,r);return{error:i}}async changePassword({newPassword:e,ticket:r}){const n=Ae(Mr(this._client)).start(),{error:i}=await Fr(n,e,r);return{error:i}}async sendVerificationEmail({email:e,options:r}){const n=Ae(Lr(this._client)).start(),{error:i}=await Gr(n,e,r);return{error:i}}async changeEmail({newEmail:e,options:r}){const n=Ae(Cr(this._client)).start(),{error:i}=await Kr(n,e,r);return{error:i}}async deanonymize(e){const r=await this.waitUntilReady();if(e.signInMethod==="passwordless"){if(e.connection==="email"){const{error:n}=await jt(r,e.email,e.options);return{error:n}}if(e.connection==="sms"){const{error:n}=await Vt(r,e.phoneNumber,e.options);return{error:n}}}if(e.signInMethod==="email-password"){const{error:n}=await Kt(r,e.email,e.password,e.options);return{error:n}}throw Error("Unknown deanonymization method")}async addSecurityKey(e){const{error:r,key:n}=await Vr(this._client,e);return{error:r,key:n}}async createPAT(e,r){return di(this._client,{expiresAt:e,metadata:r})}onTokenChanged(e){return this._client.subscribe(()=>{var n;const r=(n=this._client.interpreter)==null?void 0:n.onTransition(({event:i,context:s})=>{i.type==="TOKEN_CHANGED"&&e(Ve(s))});return()=>r==null?void 0:r.stop()})}onAuthStateChanged(e){return this._client.subscribe(()=>{var n;const r=(n=this._client.interpreter)==null?void 0:n.onTransition(({event:i,context:s})=>{(i.type==="SIGNED_IN"||i.type==="SIGNED_OUT")&&e(i.type,Ve(s))});return()=>r==null?void 0:r.stop()})}isAuthenticated(){var e;return!!((e=this._client.interpreter)!=null&&e.getSnapshot().matches({authentication:"signedIn"}))}async isAuthenticatedAsync(){return(await this.waitUntilReady()).getSnapshot().matches({authentication:"signedIn"})}getAuthenticationStatus(){var r;const e=((r=this.client.interpreter)==null?void 0:r.getSnapshot().context.importTokenAttempts)||0;return this.isReady()?{isAuthenticated:this.isAuthenticated(),isLoading:!1,connectionAttempts:e}:{isAuthenticated:!1,isLoading:!0,connectionAttempts:e}}getAccessToken(){var e,r;return(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot().context.accessToken.value)!=null?r:void 0}getDecodedAccessToken(){const e=this.getAccessToken();return e?en(e):null}getHasuraClaims(){var e;return((e=this.getDecodedAccessToken())==null?void 0:e["https://hasura.io/jwt/claims"])||null}getHasuraClaim(e){var r;return((r=this.getHasuraClaims())==null?void 0:r[e.startsWith("x-hasura-")?e:`x-hasura-${e}`])||null}async refreshSession(e){try{const r=await this.waitUntilReady();return new Promise(n=>{const i=e||r.getSnapshot().context.refreshToken.value;if(!i)return n({session:null,error:$t});const{changed:s}=r.send("TRY_TOKEN",{token:i});if(!s)return n({session:null,error:qt});r.onTransition(o=>{o.matches({token:{idle:"error"}})?n({session:null,error:zt}):o.event.type==="TOKEN_CHANGED"&&n({session:Ve(o.context),error:null})})})}catch(r){return{session:null,error:r.message}}}getSession(){var e,r;return Ve((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)}getUser(){var e,r,n;return((n=(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)==null?void 0:n.user)||null}waitUntilReady(){const r=this._client.interpreter;if(!r)throw Error("Auth interpreter not set");return r.getSnapshot().hasTag("loading")?new Promise((n,i)=>{let s=setTimeout(()=>i("The state machine is not yet ready after 15 seconds."),15e3);r.onTransition(o=>{if(!o.hasTag("loading"))return clearTimeout(s),n(r)})}):Promise.resolve(r)}isReady(){var e,r;return!((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())!=null&&r.hasTag("loading"))}get client(){return this._client}}E.AuthClient=Lt,E.AuthClientSSR=li,E.AuthCookieClient=jr,E.CodifiedError=xe,E.EMAIL_NEEDS_VERIFICATION=Yt,E.HasuraAuthClient=pi,E.INITIAL_MACHINE_CONTEXT=nt,E.INVALID_EMAIL_ERROR=ae,E.INVALID_MFA_CODE_ERROR=Bt,E.INVALID_MFA_TICKET_ERROR=Gt,E.INVALID_MFA_TYPE_ERROR=Ft,E.INVALID_PASSWORD_ERROR=Be,E.INVALID_PHONE_NUMBER_ERROR=ft,E.INVALID_REFRESH_TOKEN=zt,E.INVALID_SIGN_IN_METHOD=Xt,E.MIN_PASSWORD_LENGTH=3,E.NETWORK_ERROR_CODE=0,E.NHOST_JWT_EXPIRES_AT_KEY=pe,E.NHOST_REFRESH_TOKEN_ID_KEY=ke,E.NHOST_REFRESH_TOKEN_KEY=ie,E.NO_MFA_TICKET_ERROR=Ht,E.NO_REFRESH_TOKEN=$t,E.OTHER_ERROR_CODE=1,E.REFRESH_TOKEN_MAX_ATTEMPTS=5,E.STATE_ERROR_CODE=20,E.TOKEN_REFRESHER_RUNNING_ERROR=qt,E.TOKEN_REFRESH_MARGIN_SECONDS=60,E.USER_ALREADY_SIGNED_IN=te,E.USER_NOT_ANONYMOUS=Jr,E.USER_UNAUTHENTICATED=Wt,E.VALIDATION_ERROR_CODE=10,E.activateMfaPromise=hi,E.addSecurityKeyPromise=Vr,E.changeEmailPromise=Kr,E.changePasswordPromise=Fr,E.createAuthMachine=Dr,E.createChangeEmailMachine=Cr,E.createChangePasswordMachine=Mr,E.createEnableMfaMachine=ui,E.createResetPasswordMachine=Ur,E.createSendVerificationEmailMachine=Lr,E.encodeQueryParameters=Ct,E.generateQrCodePromise=fi,E.getAuthenticationResult=ce,E.getFetch=Nr,E.getParameterByName=Ke,E.getSession=Ve,E.isBrowser=ct,E.isValidEmail=ue,E.isValidPassword=ut,E.isValidPhoneNumber=Ut,E.isValidTicket=Pr,E.localStorageGetter=_r,E.localStorageSetter=Ir,E.postFetch=oe,E.removeParameterFromWindow=Mt,E.resetPasswordPromise=Br,E.rewriteRedirectTo=ne,E.sendVerificationEmailPromise=Gr,E.signInAnonymousPromise=Hr,E.signInEmailPasswordPromise=$r,E.signInEmailPasswordlessPromise=jt,E.signInEmailSecurityKeyPromise=qr,E.signInMfaTotpPromise=Wr,E.signInPATPromise=Yr,E.signInSmsPasswordlessOtpPromise=zr,E.signInSmsPasswordlessPromise=Vt,E.signOutPromise=Xr,E.signUpEmailPasswordPromise=Kt,E.signUpEmailSecurityKeyPromise=Qr,Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=hasura-auth-js.umd.js.map
